(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[130],{7302:function(e,t,r){Promise.resolve().then(r.bind(r,1121))},1121:function(e,t,r){"use strict";r.r(t);var l=r(7437),s=r(2265),a=r(3339),o=r(6047);t.default=()=>{let[e,t]=(0,s.useState)([]),[r,c]=(0,s.useState)(null),[n,d]=(0,s.useState)(null),[i,x]=(0,s.useState)({min:0,max:1e6}),[m,h]=(0,s.useState)(0),[p,g]=(0,s.useState)([]),[b,u]=(0,s.useState)(null),[f,j]=(0,s.useState)(!1),N=async()=>{try{let e=encodeURIComponent((null==n?void 0:n.trim())||""),r=await fetch("/api/AdminInterface/ShowApartments?city=".concat(e));if(!r.ok)throw Error("Response from server was not OK");let l=await r.json();t(l)}catch(e){c("Error fetching apartments: "+(e instanceof Error?e.message:"Unknown error")),console.error(e)}},w=async e=>{try{u(e);let t=await fetch("/api/AdminInterface/contracts?property_id=".concat(e));if(!t.ok)throw Error("Response from server was not OK");let r=await t.json();g(r),j(!0)}catch(e){c("Error fetching contracts: "+(e instanceof Error?e.message:"Unknown error")),console.error(e)}};(0,s.useEffect)(()=>{N()},[n]);let y=e.filter(e=>{let t=e.price>=i.min&&e.price<=i.max,r=!m||e.rooms===m;return t&&r}),v=(e,t)=>{let r="/contracts/".concat(e,"/").concat(t,"/contract.pdf");try{window.open(r,"_blank"),console.log("נפתח חלון חדש עם ה-PDF")}catch(e){console.error("שגיאה בפתיחת ה-PDF:",e)}},k=(e,t)=>{let r="/contracts/".concat(e,"/").concat(t,"/id_image.png"),l="/contracts/".concat(e,"/").concat(t,"/id_image.jpg"),s=e=>{window.open(e,"_blank")};s(r),s(l)};return(0,l.jsx)("div",{className:"bg-transparent text-white min-h-screen flex flex-col items-center p-6",children:(0,l.jsxs)("div",{className:"w-full max-w-4xl mx-auto",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold mb-6 text-gold text-center",children:"רשימת דירות"}),r&&(0,l.jsxs)("div",{className:"text-red-600 mb-4 text-center",children:["שגיאה: ",r]}),(0,l.jsx)(a.Z,{onPriceChange:x,onRoomsChange:h}),(0,l.jsx)(o.Z,{onCitySelect:d}),y.length>0?(0,l.jsxs)("table",{className:"min-w-full bg-transparent border border-gold mb-6",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"border-b border-gold",children:[(0,l.jsx)("th",{className:"text-left p-4",children:"מזהה נכס"}),(0,l.jsx)("th",{className:"text-left p-4",children:"עיר"}),(0,l.jsx)("th",{className:"text-left p-4",children:"מחיר"}),(0,l.jsx)("th",{className:"text-left p-4",children:"חדרים"}),(0,l.jsx)("th",{className:"text-left p-4",children:"פעולה"})]})}),(0,l.jsx)("tbody",{children:y.map(e=>(0,l.jsxs)("tr",{className:"border-b border-gold ".concat(b===e.property_id?"bg-gold/10":""),children:[(0,l.jsx)("td",{className:"p-4",children:e.property_id}),(0,l.jsx)("td",{className:"p-4",children:e.city}),(0,l.jsx)("td",{className:"p-4",children:e.price}),(0,l.jsx)("td",{className:"p-4",children:e.rooms}),(0,l.jsx)("td",{className:"p-4",children:(0,l.jsx)("button",{onClick:()=>w(e.property_id),className:"bg-gold text-black px-4 py-2 rounded hover:bg-yellow-600",children:"הצג חוזים"})})]},e.property_id))})]}):(0,l.jsx)("p",{className:"text-gray-400 text-center",children:"...טוען"}),f&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/70 flex justify-center items-center z-50",children:(0,l.jsxs)("div",{className:"bg-black text-gold p-6 rounded-lg max-w-4xl w-full max-h-screen overflow-auto",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"חוזים"}),(0,l.jsx)("button",{onClick:()=>j(!1),className:"text-red-500 mb-4 text-lg",children:"סגור"}),(0,l.jsxs)("div",{className:"overflow-x-auto max-h-80",children:[" ",(0,l.jsxs)("table",{className:"min-w-full bg-transparent border border-gold rounded-lg overflow-hidden shadow-lg",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"border-b border-gold text-gold",children:[(0,l.jsx)("th",{className:"p-4",children:"מזהה חוזה"}),(0,l.jsx)("th",{className:"p-4",children:"מזהה נכס"}),(0,l.jsx)("th",{className:"p-4",children:"סוג נכס"}),(0,l.jsx)("th",{className:"p-4 text-center",children:"תאריך"}),(0,l.jsx)("th",{className:"p-4",children:"מזהה משתמש"})]})}),(0,l.jsx)("tbody",{children:p.map((e,t)=>(0,l.jsxs)("tr",{className:"border-b border-gold hover:bg-gold/10 transition",children:[(0,l.jsx)("td",{className:"p-4 text-gold",children:e.contract_id}),(0,l.jsx)("td",{className:"p-4 text-gold",children:e.property_id}),(0,l.jsx)("td",{className:"p-4 text-gold",children:e.property_type}),(0,l.jsx)("td",{className:"p-4 text-gold",children:e.signed_date}),(0,l.jsx)("td",{className:"p-4 text-gold",children:e.user_id}),(0,l.jsx)("td",{className:"p-4 text-center",children:(0,l.jsx)("button",{className:"bg-transparent border border-gold text-gold py-1 px-3 rounded hover:bg-gold hover:text-black transition shadow-gold-glow",onClick:()=>v(e.property_type,e.contract_id),children:"הצגת החוזה"})}),(0,l.jsx)("td",{className:"p-4 text-center",children:(0,l.jsx)("button",{className:"bg-transparent border border-gold text-gold py-1 px-3 rounded hover:bg-gold hover:text-black transition shadow-gold-glow",onClick:()=>k(e.property_type,e.contract_id),children:"הצגת צילום ת.ז."})})]},t))})]})]})]})})]})})}},6047:function(e,t,r){"use strict";var l=r(7437),s=r(2265);t.Z=e=>{let{onCitySelect:t}=e,[r,a]=(0,s.useState)([]),[o,c]=(0,s.useState)(""),[n,d]=(0,s.useState)(null),[i,x]=(0,s.useState)(null),m=async()=>{try{var e;let t=await fetch("https://data.gov.il/api/3/action/datastore_search?resource_id=d4901968-dad3-4845-a9b0-a57d027f11ab");if(!t.ok)throw Error("Network response was not ok");let r=await t.json();if(r.success&&(null===(e=r.result)||void 0===e?void 0:e.records)){let e=r.result.records.map(e=>e["שם_ישוב"]).filter(e=>e);a(e)}else throw Error("Unexpected data format")}catch(e){x("Error fetching cities: ".concat(e instanceof Error?e.message:"An unknown error occurred")),console.error("Error fetching cities:",e)}};(0,s.useEffect)(()=>{m()},[]);let h=e=>{d(e),c(""),t(e)},p=r.filter(e=>e.toLowerCase().includes(o.toLowerCase()));return(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{htmlFor:"city-search",className:"block text-lg font-semibold mb-2 text-center",children:"בחר עיר:"}),(0,l.jsx)("input",{id:"city-search",type:"text",placeholder:"...הקלד שם העיר",value:o||n||"",onChange:e=>{c(e.target.value),d(null)},className:"bg-gray-800 text-white border border-gold rounded-md px-4 py-2 w-full"}),o&&(0,l.jsx)("ul",{className:"mt-2 bg-gray-800 border border-gold rounded-md max-h-48 overflow-y-auto",children:p.map((e,t)=>(0,l.jsx)("li",{onClick:()=>h(e),className:"px-4 py-2 cursor-pointer hover:bg-gray-700",children:e},t))}),i&&(0,l.jsx)("div",{className:"text-red-600 mb-4 text-center",children:i})]})}},3339:function(e,t,r){"use strict";var l=r(7437),s=r(2265);t.Z=e=>{let{onPriceChange:t,onRoomsChange:r}=e,[a,o]=(0,s.useState)(0),[c,n]=(0,s.useState)(6e6);return(0,l.jsxs)("div",{className:"filters-container mb-6 bg-transparent rounded-lg shadow-lg p-6 max-w-md mx-auto space-y-6",dir:"rtl",children:[(0,l.jsxs)("div",{className:"filter-item",children:[(0,l.jsx)("label",{className:"block text-gold font-semibold mb-2 text-right",children:"טווח מחיר:"}),(0,l.jsxs)("div",{className:"flex space-x-4",children:[(0,l.jsxs)("div",{className:"w-1/2",children:[(0,l.jsx)("label",{htmlFor:"minPrice",className:"block text-gold-lighter text-sm mb-1 text-right",children:"מינימום"}),(0,l.jsx)("input",{type:"number",id:"minPrice",min:"0",max:"6000000",step:"50000",value:a,onChange:e=>{let r=Number(e.target.value);o(r),t({min:r,max:c})},className:"w-full bg-transparent border border-gold rounded-lg py-2 px-3 text-gold focus:outline-none focus:border-gold-light placeholder-gold-lighter",placeholder:"מינימום"})]}),(0,l.jsxs)("div",{className:"w-1/2",children:[(0,l.jsx)("label",{htmlFor:"maxPrice",className:"block text-gold-lighter text-sm mb-1 text-right",children:"מקסימום"}),(0,l.jsx)("input",{type:"number",id:"maxPrice",min:"0",max:"6000000",step:"50000",value:c,onChange:e=>{let r=Number(e.target.value);n(r),t({min:a,max:r})},className:"w-full bg-transparent border border-gold rounded-lg py-2 px-3 text-gold focus:outline-none focus:border-gold-light placeholder-gold-lighter",placeholder:"מקסימום"})]})]})]}),(0,l.jsxs)("div",{className:"filter-item",children:[(0,l.jsx)("label",{htmlFor:"rooms",className:"block text-gold font-semibold mb-2 text-right",children:"חדרים:"}),(0,l.jsx)("input",{type:"number",id:"rooms",min:"1",onChange:e=>{r(Number(e.target.value))},className:"w-full bg-transparent border border-gold rounded-lg py-2 px-3 text-gold focus:outline-none focus:border-gold-light placeholder-gold-lighter",placeholder:"בחר מספר חדרים"})]})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=7302)}),_N_E=e.O()}]);