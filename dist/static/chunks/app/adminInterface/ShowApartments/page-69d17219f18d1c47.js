(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[130],{7302:function(e,t,r){Promise.resolve().then(r.bind(r,1121))},1121:function(e,t,r){"use strict";r.r(t);var s=r(7437),l=r(2265),a=r(3339),n=r(6047);t.default=()=>{let[e,t]=(0,l.useState)([]),[r,c]=(0,l.useState)(null),[o,d]=(0,l.useState)(null),[i,m]=(0,l.useState)({min:0,max:1e6}),[x,h]=(0,l.useState)(0),u=async()=>{try{let e=(null==o?void 0:o.trim())||"",r=encodeURIComponent(e);console.log("Fetching apartments with city:",r);let s=await fetch("/api/AdminInterface/ShowApartments?city=".concat(r));if(!s.ok)throw Error("Response from server was not OK");let l=await s.json();console.log("Apartments fetched:",l),t(l)}catch(e){c("Error fetching apartments: "+(e instanceof Error?e.message:"Unknown error")),console.error("Error fetching apartments:",e)}};(0,l.useEffect)(()=>{console.log("Component mounted or city changed, fetching apartments..."),u()},[o]);let p=e.filter(e=>{let t=e.price>=i.min&&e.price<=i.max,r=!x||e.rooms===x,s=!o||e.city===o;return console.log("Apartment:",e.city,s,t,r),t&&r&&s});return(0,s.jsx)("div",{className:"bg-transparent text-white min-h-screen flex flex-col items-center p-6",children:(0,s.jsxs)("div",{className:"w-full max-w-4xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6 text-gold text-center",children:"רשימת דירות"}),r&&(0,s.jsxs)("div",{className:"text-red-600 mb-4 text-center",children:["שגיאה: ",r]}),(0,s.jsx)(a.Z,{onPriceChange:m,onRoomsChange:h}),(0,s.jsx)(n.Z,{onCitySelect:d}),p.length>0?(0,s.jsxs)("table",{className:"min-w-full bg-transparent border border-gold mb-6",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gold",children:[(0,s.jsx)("th",{className:"text-left p-4",children:"מזהה נכס"}),(0,s.jsx)("th",{className:"text-left p-4",children:"עיר"}),(0,s.jsx)("th",{className:"text-left p-4",children:"מחיר"}),(0,s.jsx)("th",{className:"text-left p-4",children:"חדרים"}),(0,s.jsx)("th",{className:"text-left p-4",children:"פרטי יצירת קשר"}),(0,s.jsx)("th",{className:"text-left p-4",children:"סוג מוכר"}),(0,s.jsx)("th",{className:"text-left p-4",children:"פעולה"})]})}),(0,s.jsx)("tbody",{children:p.map(e=>(0,s.jsxs)("tr",{className:"border-b border-gold",children:[(0,s.jsx)("td",{className:"p-4",children:e.property_id}),(0,s.jsx)("td",{className:"p-4",children:e.city}),(0,s.jsx)("td",{className:"p-4",children:e.price}),(0,s.jsx)("td",{className:"p-4",children:e.rooms}),(0,s.jsx)("td",{className:"p-4",children:e.contact_seller}),(0,s.jsx)("td",{className:"p-4",children:e.seller_type}),(0,s.jsx)("td",{className:"p-4",children:(0,s.jsx)("button",{className:"bg-gold text-black px-4 py-2 rounded hover:bg-yellow-600",children:"הצג חוזים"})})]},e.property_id))})]}):(0,s.jsx)("p",{className:"text-gray-400 text-center",children:"...טוען"})]})})}},6047:function(e,t,r){"use strict";var s=r(7437),l=r(2265);t.Z=e=>{let{onCitySelect:t}=e,[r,a]=(0,l.useState)([]),[n,c]=(0,l.useState)(""),[o,d]=(0,l.useState)(null),[i,m]=(0,l.useState)(null),x=async()=>{try{var e;let t=await fetch("https://data.gov.il/api/3/action/datastore_search?resource_id=d4901968-dad3-4845-a9b0-a57d027f11ab");if(!t.ok)throw Error("Network response was not ok");let r=await t.json();if(r.success&&(null===(e=r.result)||void 0===e?void 0:e.records)){let e=r.result.records.map(e=>e["שם_ישוב"]).filter(e=>e);a(e)}else throw Error("Unexpected data format")}catch(e){m("Error fetching cities: ".concat(e instanceof Error?e.message:"An unknown error occurred")),console.error("Error fetching cities:",e)}};(0,l.useEffect)(()=>{x()},[]);let h=e=>{d(e),c(""),t(e)},u=r.filter(e=>e.toLowerCase().includes(n.toLowerCase()));return(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"city-search",className:"block text-lg font-semibold mb-2 text-center",children:"בחר עיר:"}),(0,s.jsx)("input",{id:"city-search",type:"text",placeholder:"...הקלד שם העיר",value:n||o||"",onChange:e=>{c(e.target.value),d(null)},className:"bg-gray-800 text-white border border-gold rounded-md px-4 py-2 w-full"}),n&&(0,s.jsx)("ul",{className:"mt-2 bg-gray-800 border border-gold rounded-md max-h-48 overflow-y-auto",children:u.map((e,t)=>(0,s.jsx)("li",{onClick:()=>h(e),className:"px-4 py-2 cursor-pointer hover:bg-gray-700",children:e},t))}),i&&(0,s.jsx)("div",{className:"text-red-600 mb-4 text-center",children:i})]})}},3339:function(e,t,r){"use strict";var s=r(7437),l=r(2265);t.Z=e=>{let{onPriceChange:t,onRoomsChange:r}=e,[a,n]=(0,l.useState)(""),[c,o]=(0,l.useState)(""),[d,i]=(0,l.useState)("");return(0,l.useEffect)(()=>{a&&c&&t({min:Number(a),max:Number(c)})},[a,c,t]),(0,l.useEffect)(()=>{d&&r(Number(d))},[d,r]),(0,s.jsxs)("div",{className:"flex flex-col items-center mb-6 w-full max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"text-lg font-semibold text-center mb-2",children:"טווח מחירים:"}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("input",{type:"number",value:a,onChange:e=>n(e.target.value),placeholder:"מחיר מינימלי",className:"bg-gray-800 text-white border border-gold rounded-md px-4 py-2"}),(0,s.jsx)("input",{type:"number",value:c,onChange:e=>o(e.target.value),placeholder:"מחיר מקסימלי",className:"bg-gray-800 text-white border border-gold rounded-md px-4 py-2"})]})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"text-lg font-semibold text-center mb-2",children:"מספר חדרים:"}),(0,s.jsx)("input",{type:"number",value:d,onChange:e=>i(e.target.value),placeholder:"מספר חדרים",className:"bg-gray-800 text-white border border-gold rounded-md px-4 py-2 w-full"})]})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=7302)}),_N_E=e.O()}]);