(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[130],{7302:function(e,t,r){Promise.resolve().then(r.bind(r,1121))},1121:function(e,t,r){"use strict";r.r(t);var s=r(7437),l=r(2265),a=r(3339),c=r(6047);t.default=()=>{let[e,t]=(0,l.useState)([]),[r,n]=(0,l.useState)(null),[o,i]=(0,l.useState)(null),[d,m]=(0,l.useState)({min:0,max:1e6}),[h,x]=(0,l.useState)(0),u=async()=>{try{let e=(null==o?void 0:o.trim())||"",r=encodeURIComponent(e),s=await fetch("/api/AdminInterface/ShowApartments?city=".concat(r));if(!s.ok)throw Error("Response from server was not OK");let l=await s.json();t(l)}catch(e){n("Error fetching apartments: "+(e instanceof Error?e.message:"Unknown error")),console.error("Error fetching apartments:",e)}};(0,l.useEffect)(()=>{u()},[o]);let p=e.filter(e=>{let t=e.price>=d.min&&e.price<=d.max,r=!h||e.rooms===h,s=!o||e.city===o;return t&&r&&s});return(0,s.jsx)("div",{className:"bg-transparent text-white min-h-screen flex flex-col items-center p-6",children:(0,s.jsxs)("div",{className:"w-full max-w-4xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6 text-gold text-center",children:"רשימת דירות"}),r&&(0,s.jsxs)("div",{className:"text-red-600 mb-4 text-center",children:["שגיאה: ",r]}),(0,s.jsx)(a.Z,{onPriceChange:m,onRoomsChange:x}),(0,s.jsx)(c.Z,{onCitySelect:i}),p.length>0?(0,s.jsxs)("table",{className:"min-w-full bg-transparent border border-gold mb-6",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gold",children:[(0,s.jsx)("th",{className:"text-left p-4",children:"מזהה נכס"}),(0,s.jsx)("th",{className:"text-left p-4",children:"עיר"}),(0,s.jsx)("th",{className:"text-left p-4",children:"מחיר"}),(0,s.jsx)("th",{className:"text-left p-4",children:"חדרים"}),(0,s.jsx)("th",{className:"text-left p-4",children:"פרטי יצירת קשר"}),(0,s.jsx)("th",{className:"text-left p-4",children:"סוג מוכר"}),(0,s.jsx)("th",{className:"text-left p-4",children:"פעולה"})]})}),(0,s.jsx)("tbody",{children:p.map(e=>(0,s.jsxs)("tr",{className:"border-b border-gold",children:[(0,s.jsx)("td",{className:"p-4",children:e.property_id}),(0,s.jsx)("td",{className:"p-4",children:e.city}),(0,s.jsx)("td",{className:"p-4",children:e.price}),(0,s.jsx)("td",{className:"p-4",children:e.rooms}),(0,s.jsx)("td",{className:"p-4",children:e.contact_seller}),(0,s.jsx)("td",{className:"p-4",children:e.seller_type}),(0,s.jsx)("td",{className:"p-4",children:(0,s.jsx)("button",{className:"bg-gold text-black px-4 py-2 rounded hover:bg-yellow-600",children:"הצג חוזים"})})]},e.property_id))})]}):(0,s.jsx)("p",{className:"text-gray-400 text-center",children:"...טוען"})]})})}},6047:function(e,t,r){"use strict";var s=r(7437),l=r(2265);t.Z=e=>{let{onCitySelect:t}=e,[r,a]=(0,l.useState)([]),[c,n]=(0,l.useState)(""),[o,i]=(0,l.useState)(null),[d,m]=(0,l.useState)(null),h=async()=>{try{var e;let t=await fetch("https://data.gov.il/api/3/action/datastore_search?resource_id=d4901968-dad3-4845-a9b0-a57d027f11ab");if(!t.ok)throw Error("Network response was not ok");let r=await t.json();if(r.success&&(null===(e=r.result)||void 0===e?void 0:e.records)){let e=r.result.records.map(e=>e["שם_ישוב"]).filter(e=>e);a(e)}else throw Error("Unexpected data format")}catch(e){m("Error fetching cities: ".concat(e instanceof Error?e.message:"An unknown error occurred")),console.error("Error fetching cities:",e)}};(0,l.useEffect)(()=>{h()},[]);let x=e=>{i(e),n(""),t(e)},u=r.filter(e=>e.toLowerCase().includes(c.toLowerCase()));return(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"city-search",className:"block text-lg font-semibold mb-2 text-center",children:"בחר עיר:"}),(0,s.jsx)("input",{id:"city-search",type:"text",placeholder:"...הקלד שם העיר",value:c||o||"",onChange:e=>{n(e.target.value),i(null)},className:"bg-gray-800 text-white border border-gold rounded-md px-4 py-2 w-full"}),c&&(0,s.jsx)("ul",{className:"mt-2 bg-gray-800 border border-gold rounded-md max-h-48 overflow-y-auto",children:u.map((e,t)=>(0,s.jsx)("li",{onClick:()=>x(e),className:"px-4 py-2 cursor-pointer hover:bg-gray-700",children:e},t))}),d&&(0,s.jsx)("div",{className:"text-red-600 mb-4 text-center",children:d})]})}},3339:function(e,t,r){"use strict";var s=r(7437);r(2265),t.Z=e=>{let{onPriceChange:t,onRoomsChange:r}=e;return(0,s.jsxs)("div",{className:"filters-container mb-6",children:[(0,s.jsxs)("div",{className:"filter-item",children:[(0,s.jsx)("label",{htmlFor:"price",children:"מחיר:"}),(0,s.jsx)("input",{type:"range",id:"price",min:"0",max:"10000",step:"500",onChange:e=>{let r=Number(e.target.value);t({min:r,max:r+5e3})},className:"w-full"})]}),(0,s.jsxs)("div",{className:"filter-item",children:[(0,s.jsx)("label",{htmlFor:"rooms",children:"חדרים:"}),(0,s.jsx)("input",{type:"number",id:"rooms",min:"1",onChange:e=>{r(Number(e.target.value))},className:"w-full"})]})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=7302)}),_N_E=e.O()}]);