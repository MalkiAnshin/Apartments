(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{2307:function(e,t,r){Promise.resolve().then(r.bind(r,6374))},1054:function(e,t,r){"use strict";r.d(t,{R:function(){return a},b:function(){return u}});var s=r(7437),n=r(2265);let o=(0,n.createContext)(void 0),a=e=>{let{children:t}=e,[r,a]=(0,n.useState)(null),[u,l]=(0,n.useState)(null),[i,d]=(0,n.useState)(null),[c,g]=(0,n.useState)(null);return(0,s.jsx)(o.Provider,{value:{user:r,setUser:a,userType:u,setUserType:l,userId:i,setUserId:d,firstListingFree:c,setFirstListingFree:g},children:t})},u=()=>{let e=(0,n.useContext)(o);if(!e)throw Error("useGlobalContext must be used within a GlobalProvider");return e}},6374:function(e,t,r){"use strict";r.r(t);var s=r(7437),n=r(2265),o=r(9376),a=r(1054);t.default=()=>{let[e,t]=(0,n.useState)(""),[r,u]=(0,n.useState)(""),[l,i]=(0,n.useState)(""),[d,c]=(0,n.useState)(""),[g,h]=(0,n.useState)(!1),[p,x]=(0,n.useState)(null),[m,f]=(0,n.useState)(!1),y=(0,o.useRouter)(),{setUser:b,setUserType:w,setUserId:j,setFirstListingFree:k}=(0,a.b)(),v=e=>{let t=e.padStart(9,"0"),r=0;for(let e=0;e<t.length;e++){let s=parseInt(t[e])*(e%2==0?1:2);r+=s>9?s-9:s}return r%10==0},N=async()=>{if(!v(e)){x("מספר הזהות אינו תקין");return}if(d.length<6){x("הסיסמא חייבת להיות לפחות 6 תווים");return}try{let t=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identityNumber:e,password:d})}),r=await t.json();if(t.ok){b(r.username);let e={username:r.username,userType:r.userType,userId:r.userId,firstListingFree:r.firstListingFree};localStorage.setItem("user",JSON.stringify(e)),w(r.userType),j(r.userId),k(r.firstListingFree),y.push("admin"===r.userType?"/admin/dashboard":"/")}else console.error("Error during login:",r.message),x(r.message||"התרחשה שגיאה")}catch(e){console.error("An error occurred during login:",e),x("שגיאה בשרת, נסה שנית מאוחר יותר")}},S=async()=>{if(!v(e)){x("מספר הזהות אינו תקין");return}if(d.length<6){x("הסיסמא חייבת להיות לפחות 6 תווים");return}try{let t=await fetch("/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identityNumber:e,name:r,email:l,password:d})});if(t.ok){let e=await t.json();b(r),w(e.userType);let s={username:e.username,userType:e.userType,userId:e.userId,firstListingFree:e.firstListingFree};localStorage.setItem("user",JSON.stringify(s)),j(e.userId),k(e.firstListingFree);let n=localStorage.getItem("redirectAfterLogin")||"/";y.push(n)}else{let e=await t.json();console.error("Error during registration:",e.message),x(e.message||"התרחשה שגיאה")}}catch(e){console.error("An error occurred during registration:",e),x("שגיאה בשרת, נסה שנית מאוחר יותר")}};return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-dark-black text-white",children:(0,s.jsxs)("div",{className:"bg-black p-8 rounded-lg shadow-lg w-full max-w-sm",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-luxury-gold mb-4",children:m?"הרשמה":"התחברות למערכת"}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),m?S():N()},children:[(0,s.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"מספר זהות",className:"w-full p-2 mb-4 border border-luxury-gold rounded bg-gray-800 text-white",required:!0,autoComplete:"identityNumber"}),m&&(0,s.jsx)("input",{type:"text",value:r,onChange:e=>u(e.target.value),placeholder:"שם",className:"w-full p-2 mb-4 border border-luxury-gold rounded bg-gray-800 text-white",required:!0,autoComplete:"name"}),m&&(0,s.jsx)("input",{type:"email",value:l,onChange:e=>i(e.target.value),placeholder:"אימייל",className:"w-full p-2 mb-4 border border-luxury-gold rounded bg-gray-800 text-white",required:!0,autoComplete:"email"}),(0,s.jsxs)("div",{className:"relative mb-6",children:[(0,s.jsx)("input",{type:g?"text":"password",value:d,onChange:e=>c(e.target.value),placeholder:"סיסמא",className:"w-full p-2 border border-luxury-gold rounded bg-gray-800 text-white",required:!0,autoComplete:"current-password"}),(0,s.jsx)("span",{className:"absolute right-3 top-2 cursor-pointer",onClick:()=>h(!g),children:g?(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-luxury-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 12s2.5-6 9-6 9 6 9 6-2.5 6-9 6-9-6-9-6z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15.5A3.5 3.5 0 0015.5 12 3.5 3.5 0 0012 8.5 3.5 3.5 0 008.5 12 3.5 3.5 0 0012 15.5z"})]}):(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-luxury-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12s-1.5-3-6-3-6 3-6 3 2.5 6 9 6 9-6 9-6z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 16.5a4.5 4.5 0 110-9 4.5 4.5 0 010 9z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 10.5l-1.5-1.5M12 10.5l1.5-1.5"})]})})]}),p&&(0,s.jsx)("p",{className:"text-red-500 mb-4",children:p}),(0,s.jsx)("button",{type:"submit",className:"w-full bg-luxury-gold text-dark-black p-2 rounded hover:bg-yellow-600 transition duration-300",children:m?"הרשמה":"התחברות"})]}),!m&&(0,s.jsxs)("p",{className:"mt-4 text-center text-gray-400",children:["לא רשום עדיין? ",(0,s.jsx)("span",{className:"text-luxury-gold cursor-pointer",onClick:()=>f(!0),children:"הרשם"})]}),m&&(0,s.jsxs)("p",{className:"mt-4 text-center text-gray-400",children:["כבר יש לך חשבון?"," ",(0,s.jsx)("span",{className:"text-luxury-gold cursor-pointer",onClick:()=>f(!1),children:"התחבר"})]})]})})}},9376:function(e,t,r){"use strict";var s=r(5475);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[971,117,744],function(){return e(e.s=2307)}),_N_E=e.O()}]);