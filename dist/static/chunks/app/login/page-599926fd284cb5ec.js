(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{2307:function(e,r,t){Promise.resolve().then(t.bind(t,6374))},1054:function(e,r,t){"use strict";t.d(r,{R:function(){return a},b:function(){return l}});var s=t(7437),o=t(2265);let n=(0,o.createContext)(void 0),a=e=>{let{children:r}=e,[t,a]=(0,o.useState)(null),[l,u]=(0,o.useState)(null),[i,d]=(0,o.useState)(null),[c,g]=(0,o.useState)(null);return(0,s.jsx)(n.Provider,{value:{user:t,setUser:a,userType:l,setUserType:u,userId:i,setUserId:d,firstListingFree:c,setFirstListingFree:g},children:r})},l=()=>{let e=(0,o.useContext)(n);if(!e)throw Error("useGlobalContext must be used within a GlobalProvider");return e}},6374:function(e,r,t){"use strict";t.r(r);var s=t(7437),o=t(2265),n=t(9376),a=t(1054);r.default=()=>{let[e,r]=(0,o.useState)(""),[t,l]=(0,o.useState)(""),[u,i]=(0,o.useState)(""),[d,c]=(0,o.useState)(""),[g,p]=(0,o.useState)(!1),[h,m]=(0,o.useState)(null),[x,f]=(0,o.useState)(!1),y=(0,n.useRouter)(),{setUser:b,setUserType:w,setUserId:j,setFirstListingFree:k}=(0,a.b)(),v=async()=>{if(d.length<6){m("הסיסמא חייבת להיות לפחות 6 תווים");return}try{let r=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identityNumber:e,password:d})}),t=await r.json();if(console.log("API Response:",t),r.ok){console.log("Login successful:",t.userType),b(t.username);let e={username:t.username,userType:t.userType,userId:t.userId,firstListingFree:t.firstListingFree};localStorage.setItem("user",JSON.stringify(e)),console.log("User saved to localStorage:",e),w(t.userType),j(t.userId),k(t.firstListingFree),y.push("admin"===t.userType?"/admin/dashboard":"/")}else console.error("Error during login:",t.message),m(t.message||"התרחשה שגיאה")}catch(e){console.error("An error occurred during login:",e),m("שגיאה בשרת, נסה שנית מאוחר יותר")}},N=async()=>{if(d.length<6){m("הסיסמא חייבת להיות לפחות 6 תווים");return}try{let r=await fetch("/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identityNumber:e,name:t,email:u,password:d})});if(r.ok){let e=await r.json();console.log("Registration successful:",t),b(t),w(e.userType);let s={username:e.username,userType:e.userType,userId:e.userId,firstListingFree:e.firstListingFree};localStorage.setItem("user",JSON.stringify(s)),console.log("User saved to localStorage:",s),j(e.userId),k(e.firstListingFree),y.push("admin"===e.userType?"/admin/dashboard":"/")}else{let e=await r.json();console.error("Error during registration:",e.message),m(e.message||"התרחשה שגיאה")}}catch(e){console.error("An error occurred during registration:",e),m("שגיאה בשרת, נסה שנית מאוחר יותר")}};return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-dark-black text-white",children:(0,s.jsxs)("div",{className:"bg-black p-8 rounded-lg shadow-lg w-full max-w-sm",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-luxury-gold mb-4",children:x?"הרשמה":"התחברות למערכת"}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),x?N():v()},children:[(0,s.jsx)("input",{type:"text",value:e,onChange:e=>r(e.target.value),placeholder:"מספר זהות",className:"w-full p-2 mb-4 border border-luxury-gold rounded bg-gray-800 text-white",required:!0,autoComplete:"identityNumber"}),x&&(0,s.jsx)("input",{type:"text",value:t,onChange:e=>l(e.target.value),placeholder:"שם",className:"w-full p-2 mb-4 border border-luxury-gold rounded bg-gray-800 text-white",required:!0,autoComplete:"name"}),x&&(0,s.jsx)("input",{type:"email",value:u,onChange:e=>i(e.target.value),placeholder:"אימייל",className:"w-full p-2 mb-4 border border-luxury-gold rounded bg-gray-800 text-white",required:!0,autoComplete:"email"}),(0,s.jsxs)("div",{className:"relative mb-6",children:[(0,s.jsx)("input",{type:g?"text":"password",value:d,onChange:e=>c(e.target.value),placeholder:"סיסמא",className:"w-full p-2 border border-luxury-gold rounded bg-gray-800 text-white",required:!0,autoComplete:"current-password"}),(0,s.jsx)("span",{className:"absolute right-3 top-2 cursor-pointer",onClick:()=>p(!g),children:g?(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-luxury-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 12s2.5-6 9-6 9 6 9 6-2.5 6-9 6-9-6-9-6z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15.5A3.5 3.5 0 0015.5 12 3.5 3.5 0 0012 8.5 3.5 3.5 0 008.5 12 3.5 3.5 0 0012 15.5z"})]}):(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-luxury-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12s-1.5-3-6-3-6 3-6 3 2.5 6 9 6 9-6 9-6z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 16.5a4.5 4.5 0 110-9 4.5 4.5 0 010 9z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 10.5l-1.5-1.5M12 10.5l1.5-1.5"})]})})]}),h&&(0,s.jsx)("p",{className:"text-red-500 mb-4",children:h}),(0,s.jsx)("button",{type:"submit",className:"w-full bg-luxury-gold text-dark-black p-2 rounded hover:bg-yellow-600 transition duration-300",children:x?"הרשמה":"התחברות"})]}),!x&&(0,s.jsxs)("p",{className:"mt-4 text-center text-gray-400",children:["לא רשום עדיין? ",(0,s.jsx)("span",{className:"text-luxury-gold cursor-pointer",onClick:()=>f(!0),children:"הרשם"})]}),x&&(0,s.jsxs)("p",{className:"mt-4 text-center text-gray-400",children:["כבר יש לך חשבון?"," ",(0,s.jsx)("span",{className:"text-luxury-gold cursor-pointer",onClick:()=>f(!1),children:"התחבר"})]})]})})}},9376:function(e,r,t){"use strict";var s=t(5475);t.o(s,"usePathname")&&t.d(r,{usePathname:function(){return s.usePathname}}),t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[971,117,744],function(){return e(e.s=2307)}),_N_E=e.O()}]);