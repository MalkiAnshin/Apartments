(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[430],{36773:function(e,t,l){Promise.resolve().then(l.bind(l,11853))},81054:function(e,t,l){"use strict";l.d(t,{R:function(){return o},b:function(){return n}});var s=l(57437),r=l(2265);let a=(0,r.createContext)(void 0),o=e=>{let{children:t}=e,[l,o]=(0,r.useState)(null),[n,i]=(0,r.useState)(null),[d,c]=(0,r.useState)(null),[u,x]=(0,r.useState)(null);return(0,s.jsx)(a.Provider,{value:{user:l,setUser:o,userType:n,setUserType:i,userId:d,setUserId:c,remainingListings:u,setRemainingListings:x},children:t})},n=()=>{let e=(0,r.useContext)(a);if(!e)throw Error("useGlobalContext must be used within a GlobalProvider");return e}},11853:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return u}});var s=l(57437),r=l(2265),a=l(81054),o=l(99376),n=()=>{let[e,t]=(0,r.useState)([]),[l,a]=(0,r.useState)(""),[n,i]=(0,r.useState)([]),[d,c]=(0,r.useState)(null),[u,x]=(0,r.useState)([]),[p,h]=(0,r.useState)(!1),g=(0,o.useRouter)();(0,r.useEffect)(()=>{let e=localStorage.getItem("user"),t=e?JSON.parse(e):null;t&&t.userId&&c(t.userId)},[]);let m=e=>{console.log("City selected:",e),a(e),i([])},b=async e=>{try{console.log("Starting fetch for cities...");let t=await fetch("https://data.gov.il/api/3/action/datastore_search?resource_id=d4901968-dad3-4845-a9b0-a57d027f11ab");if(!t.ok)throw Error("Network response was not ok");let l=await t.json();if(l.success&&l.result&&l.result.records){let t=l.result.records.map(e=>e["שם_ישוב"]).filter(t=>""!==t&&t.toLowerCase().includes(e.toLowerCase()));console.log("Cities fetched successfully:",t),i(t)}}catch(e){console.error("Error fetching cities:",e)}},f=t=>{let l=[];return console.log("Validating form data..."),t.get("city")||l.push("העיר היא שדה חובה"),t.get("neighborhood")||l.push("השכונה היא שדה חובה"),t.get("price")||l.push("המחיר הוא שדה חובה"),t.get("rooms")||l.push("מספר החדרים הוא שדה חובה"),t.get("floor")||l.push("הקומה היא שדה חובה"),t.get("contactSeller")||l.push("דרכי יצירת קשר עם המוכר הם שדה חובה"),t.get("address")||l.push("הכתובת היא שדה חובה"),0===e.length&&l.push("יש להעלות תמונות של הנכס"),l.length>0?console.log("Form validation failed:",l):console.log("Form validation passed."),x(l),0===l.length},N=async t=>{if(t.preventDefault(),p)return;h(!0),console.log("Form submission started..."),console.log("Images state before submit:",e),e.forEach((e,t)=>{console.log("Image #".concat(t+1,": name=").concat(e.name,", size=").concat(e.size," bytes, type=").concat(e.type))});let l=new FormData,s=t.target;if(l.append("city",s.city.value),l.append("neighborhood",s.neighborhood.value),l.append("price",s.price.value),l.append("propertyType","Apartment"),l.append("userId",d||""),l.append("rooms",s.rooms.value),l.append("hasBalcony",s.hasBalcony.checked?"true":"false"),l.append("floor",s.floor.value),l.append("contactSeller",s.contactSeller.value),l.append("address",s.address.value),l.append("elevator",s.elevator.checked?"true":"false"),l.append("warehouse",s.warehouse.checked?"true":"false"),l.append("parking",s.parking.checked?"true":"false"),e.forEach((e,t)=>{console.log("Appending image #".concat(t+1," to formData:"),e.name),l.append("images",e)}),console.log("FormData content before sending:"),l.forEach((e,t)=>{"images"===t&&e instanceof File?console.log("Key: ".concat(t,", File name: ").concat(e.name,", size: ").concat(e.size)):console.log("Key: ".concat(t,", Value:"),e)}),f(l)){console.log("Submitting form data to the server...");let e=await fetch("/api/postProperty",{method:"POST",body:l}),t=await e.json();if(e.ok){console.log("Form submitted successfully:",t),alert("✅ נכס נקלט בהצלחה!");let e=localStorage.getItem("user");if(e){let t=JSON.parse(e);t.remainingListings=t.remainingListings-1,localStorage.setItem("user",JSON.stringify(t))}g.push("/")}else console.error("Error submitting form:",t.error),alert("Error: "+t.error)}h(!1)};return(0,s.jsxs)("form",{onSubmit:N,className:"bg-transparent p-6 rounded-lg shadow-lg max-w-lg mx-auto",children:[(0,s.jsx)("h2",{className:"text-3xl font-bold text-center text-gold-500 mb-6",children:"פרסום דירה"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col relative",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"עיר"}),(0,s.jsx)("input",{type:"text",value:l,onChange:e=>{let t=e.target.value;console.log("City input changed:",t),a(t),t?(console.log("Fetching cities for term:",t),b(t)):(console.log("Clearing city suggestions."),i([]))},name:"city",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"}),n.length>0&&(0,s.jsx)("ul",{className:"absolute bg-transparent text-gold border border-gold w-auto max-w-fit max-h-60 overflow-y-auto z-10 rounded-md mt-1 shadow-lg px-2 py-1 top-full left-0",children:n.map(e=>(0,s.jsx)("li",{onClick:()=>m(e),className:"cursor-pointer hover:bg-gray-700 p-3",children:e},e))})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"איזור/שכונה"}),(0,s.jsx)("input",{type:"text",name:"neighborhood",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"מחיר"}),(0,s.jsx)("input",{type:"number",name:"price",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"מספר חדרים"}),(0,s.jsx)("input",{type:"number",name:"rooms",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"קומה"}),(0,s.jsx)("input",{type:"number",name:"floor",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"דרכי יצירת קשר עם המוכר"}),(0,s.jsx)("input",{type:"text",name:"contactSeller",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"כתובת"}),(0,s.jsx)("input",{type:"text",name:"address",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"יש מרפסת?"}),(0,s.jsx)("input",{type:"checkbox",name:"hasBalcony",className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"יש מעלית?"}),(0,s.jsx)("input",{type:"checkbox",name:"elevator",className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"יש מחסן?"}),(0,s.jsx)("input",{type:"checkbox",name:"warehouse",className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"יש חניה"}),(0,s.jsx)("input",{type:"checkbox",name:"parking",className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"תמונות הנכס"}),(0,s.jsx)("input",{type:"file",multiple:!0,onChange:e=>t(Array.from(e.target.files||[])),className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsx)("button",{type:"submit",className:"bg-gold-500 text-black py-2 px-4 rounded-lg w-full hover:bg-gold-600",disabled:p,children:"שלח"})]})]})},i=()=>{let[e,t]=(0,r.useState)([]),[l,a]=(0,r.useState)(""),[n,i]=(0,r.useState)([]),[d,c]=(0,r.useState)(null),[u,x]=(0,r.useState)([]),[p,h]=(0,r.useState)(!1),g=(0,o.useRouter)();(0,r.useEffect)(()=>{let e=localStorage.getItem("user"),t=e?JSON.parse(e):null;t&&t.userId&&c(t.userId)},[]);let m=e=>{console.log("City selected:",e),a(e),i([])},b=async e=>{try{console.log("Starting fetch for cities...");let t=await fetch("https://data.gov.il/api/3/action/datastore_search?resource_id=d4901968-dad3-4845-a9b0-a57d027f11ab");if(!t.ok)throw Error("Network response was not ok");let l=await t.json();if(l.success&&l.result&&l.result.records){let t=l.result.records.map(e=>e["שם_ישוב"]).filter(t=>""!==t&&t.toLowerCase().includes(e.toLowerCase()));console.log("Cities fetched successfully:",t),i(t)}}catch(e){console.error("Error fetching cities:",e)}},f=t=>{let l=[];return console.log("Validating form data..."),t.get("city")||l.push("העיר היא שדה חובה"),t.get("neighborhood")||l.push("השכונה היא שדה חובה"),t.get("price")||l.push("המחיר הוא שדה חובה"),t.get("rooms")||l.push("מספר החדרים הוא שדה חובה"),t.get("floor")||l.push("הקומה היא שדה חובה"),t.get("contactSeller")||l.push("דרכי יצירת קשר עם המוכר הם שדה חובה"),t.get("address")||l.push("הכתובת היא שדה חובה"),t.get("isBuilt")||l.push("לא ציינת האם הפרויקט בנוי או לא"),0===e.length&&l.push("יש להעלות תמונות של הנכס"),l.length>0?console.log("Form validation failed:",l):console.log("Form validation passed."),x(l),0===l.length},N=async t=>{if(t.preventDefault(),p)return;h(!0),console.log("\uD83D\uDE80 התחלת שליחת טופס...");let l=new FormData,s=t.target;if(l.append("city",s.city.value),l.append("neighborhood",s.neighborhood.value),l.append("price",s.price.value),l.append("propertyType","Project"),l.append("userId",d||""),l.append("rooms",s.rooms.value),l.append("hasBalcony",s.hasBalcony.checked?"true":"false"),l.append("floor",s.floor.value),l.append("contactSeller",s.contactSeller.value),l.append("address",s.address.value),l.append("elevator",s.elevator.checked?"true":"false"),l.append("isBuilt",s.isBuilt.checked?"true":"false"),l.append("warehouse",s.warehouse.checked?"true":"false"),l.append("parking",s.parking.checked?"true":"false"),e.forEach(e=>{l.append("images",e)}),console.log("Form data to be sent to the server:"),l.forEach((e,t)=>{console.log("".concat(t,":"),e)}),f(l)){console.log("\uD83D\uDCE4 שליחת נתונים לשרת:"),l.forEach((e,t)=>{console.log("\uD83D\uDC49 ".concat(t,":"),e)});try{let e=await fetch("/api/postProperty",{method:"POST",body:l});console.log("\uD83D\uDCE9 תשובה שהתקבלה מהשרת:",e);let t=await e.json();if(console.log("\uD83D\uDCE9 JSON שהתקבל מהשרת:",t),e.ok){console.log("\uD83C\uDF89 נכס נשמר בהצלחה:",t),alert("✅ נכס נקלט בהצלחה!");let e=localStorage.getItem("user");if(e){let t=JSON.parse(e);t.remainingListings=t.remainingListings-1,localStorage.setItem("user",JSON.stringify(t))}g.push("/")}else console.error("❌ שגיאה בשליחה לשרת:",t.error),alert("❌ שגיאה: "+t.error)}catch(e){console.error("\uD83D\uDD25 שגיאה כללית בשליחה:",e),alert("⚠️ שגיאה לא צפויה, בדוק את הקונסולה.")}}h(!1)};return(0,s.jsxs)("form",{onSubmit:N,className:"bg-transparent p-6 rounded-lg shadow-lg max-w-lg mx-auto",children:[(0,s.jsx)("h2",{className:"text-3xl font-bold text-center text-gold-500 mb-6",children:"פרסום דירת פרויקט"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col relative",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"עיר"}),(0,s.jsx)("input",{type:"text",value:l,onChange:e=>{let t=e.target.value;console.log("City input changed:",t),a(t),t?(console.log("Fetching cities for term:",t),b(t)):(console.log("Clearing city suggestions."),i([]))},name:"city",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"}),n.length>0&&(0,s.jsx)("ul",{className:"absolute bg-transparent text-gold border border-gold w-auto max-w-fit max-h-60 overflow-y-auto z-10 rounded-md mt-1 shadow-lg px-2 py-1 top-full left-0",children:n.map(e=>(0,s.jsx)("li",{onClick:()=>m(e),className:"cursor-pointer hover:bg-gray-700 p-3",children:e},e))})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"איזור/שכונה"}),(0,s.jsx)("input",{type:"text",name:"neighborhood",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"מחיר"}),(0,s.jsx)("input",{type:"number",name:"price",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"מספר חדרים"}),(0,s.jsx)("input",{type:"number",name:"rooms",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"קומה"}),(0,s.jsx)("input",{type:"number",name:"floor",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"דרכי יצירת קשר עם המוכר"}),(0,s.jsx)("input",{type:"text",name:"contactSeller",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"כתובת"}),(0,s.jsx)("input",{type:"text",name:"address",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"יש מרפסת?"}),(0,s.jsx)("input",{type:"checkbox",name:"hasBalcony",className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"יש מעלית?"}),(0,s.jsx)("input",{type:"checkbox",name:"elevator",className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"יש מחסן?"}),(0,s.jsx)("input",{type:"checkbox",name:"warehouse",className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"יש חניה"}),(0,s.jsx)("input",{type:"checkbox",name:"parking",className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"האם הדירה בנויה?"}),(0,s.jsx)("input",{type:"checkbox",name:"isBuilt",className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"תמונות הנכס"}),(0,s.jsx)("input",{type:"file",multiple:!0,onChange:e=>t(Array.from(e.target.files||[])),className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsx)("button",{type:"submit",className:"bg-gold-500 text-black py-2 px-4 rounded-lg w-full hover:bg-gold-600",disabled:p,children:"שלח"})]})]})},d=()=>{let[e,t]=(0,r.useState)(""),[l,a]=(0,r.useState)([]),[n,i]=(0,r.useState)(null),[d,c]=(0,r.useState)([]),[u,x]=(0,r.useState)(!1),p=(0,o.useRouter)();(0,r.useEffect)(()=>{console.log("Checking for user data in localStorage...");let e=localStorage.getItem("user"),t=e?JSON.parse(e):null;t&&t.userId?(console.log("User found:",t),i(t.userId)):console.log("No user found in localStorage.")},[]);let h=e=>{console.log("City selected:",e),t(e),a([])},g=async e=>{try{console.log("Starting fetch for cities...");let t=await fetch("https://data.gov.il/api/3/action/datastore_search?resource_id=d4901968-dad3-4845-a9b0-a57d027f11ab");if(!t.ok)throw Error("Network response was not ok");let l=await t.json();if(l.success&&l.result&&l.result.records){let t=l.result.records.map(e=>e["שם_ישוב"]).filter(t=>""!==t&&t.toLowerCase().includes(e.toLowerCase()));console.log("Cities fetched successfully:",t),a(t)}}catch(e){console.error("Error fetching cities:",e)}},m=e=>{let t=[];return console.log("Validating form data..."),e.get("city")||t.push("העיר היא שדה חובה"),e.get("neighborhood")||t.push("השכונה היא שדה חובה"),e.get("price")||t.push("המחיר הוא שדה חובה"),e.get("contactSeller")||t.push("דרכי יצירת קשר עם המוכר הם שדה חובה"),e.get("address")||t.push("הכתובת היא שדה חובה"),e.get("size")||t.push("הגודל הוא שדה חובה"),e.get("buildable_area")||t.push("האם בנוי או לא הינו שדה חובה"),t.length>0?console.log("Form validation failed:",t):console.log("Form validation passed."),c(t),0===t.length},b=async e=>{if(e.preventDefault(),u)return;x(!0),console.log("Form submission started...");let t=new FormData,l=e.target;if(t.append("city",l.city.value),t.append("neighborhood",l.neighborhood.value),t.append("price",l.price.value),t.append("propertyType","Land"),t.append("userId",n||""),t.append("contactSeller",l.contactSeller.value),t.append("address",l.address.value),t.append("size",l.size.value),t.append("buildable_area",l.buildable_area.checked?"true":"false"),console.log("Form data to be sent to the server:"),t.forEach((e,t)=>{console.log("".concat(t,":"),e)}),m(t)){console.log("Submitting form data to the server...");let e=await fetch("/api/postProperty",{method:"POST",body:t}),l=await e.json();if(e.ok){console.log("Form submitted successfully:",l),alert("✅ נכס נקלט בהצלחה!");let e=localStorage.getItem("user");if(e){let t=JSON.parse(e);t.remainingListings=t.remainingListings-1,localStorage.setItem("user",JSON.stringify(t))}p.push("/")}else console.error("Error submitting form:",l.error),alert("Error: "+l.error)}x(!1)};return(0,s.jsxs)("form",{onSubmit:b,className:"bg-transparent p-6 rounded-lg shadow-lg max-w-lg mx-auto",children:[(0,s.jsx)("h2",{className:"text-3xl font-bold text-center text-gold-500 mb-6",children:"פרסום קרקע"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col relative",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"עיר"}),(0,s.jsx)("input",{type:"text",value:e,onChange:e=>{let l=e.target.value;console.log("City input changed:",l),t(l),l?(console.log("Fetching cities for term:",l),g(l)):(console.log("Clearing city suggestions."),a([]))},name:"city",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"}),l.length>0&&(0,s.jsx)("ul",{className:"absolute bg-transparent text-gold border border-gold w-auto max-w-fit max-h-60 overflow-y-auto z-10 rounded-md mt-1 shadow-lg px-2 py-1 top-full left-0",children:l.map(e=>(0,s.jsx)("li",{onClick:()=>h(e),className:"cursor-pointer hover:bg-gray-700 p-3",children:e},e))})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"איזור/שכונה"}),(0,s.jsx)("input",{type:"text",name:"neighborhood",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"מחיר"}),(0,s.jsx)("input",{type:"number",name:"price",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"דרכי יצירת קשר עם המוכר"}),(0,s.jsx)("input",{type:"text",name:"contactSeller",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"כתובת"}),(0,s.jsx)("input",{type:"text",name:"address",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:'גודל במ"ר'}),(0,s.jsx)("input",{type:"number",name:"size",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"האם הקרקע בשטח בנוי?"}),(0,s.jsx)("input",{type:"checkbox",name:"buildable_area",onChange:e=>e.target.setAttribute("value",e.target.checked?"true":"false"),className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsx)("button",{type:"submit",className:"bg-gold-500 text-black py-2 px-4 rounded-lg w-full hover:bg-gold-600",disabled:u,children:"שלח"})]})]})},c=()=>{let[e,t]=(0,r.useState)([]),[l,a]=(0,r.useState)(""),[n,i]=(0,r.useState)([]),[d,c]=(0,r.useState)(null),[u,x]=(0,r.useState)([]),[p,h]=(0,r.useState)(!1),g=(0,o.useRouter)();(0,r.useEffect)(()=>{let e=localStorage.getItem("user"),t=e?JSON.parse(e):null;t&&t.userId&&c(t.userId)},[]);let m=e=>{console.log("City selected:",e),a(e),i([])},b=async e=>{try{console.log("Starting fetch for cities...");let t=await fetch("https://data.gov.il/api/3/action/datastore_search?resource_id=d4901968-dad3-4845-a9b0-a57d027f11ab");if(!t.ok)throw Error("Network response was not ok");let l=await t.json();if(l.success&&l.result&&l.result.records){let t=l.result.records.map(e=>e["שם_ישוב"]).filter(t=>""!==t&&t.toLowerCase().includes(e.toLowerCase()));console.log("Cities fetched successfully:",t),i(t)}}catch(e){console.error("Error fetching cities:",e)}},f=e=>{let t=[];return console.log("Validating form data..."),e.get("city")||t.push("העיר היא שדה חובה"),e.get("neighborhood")||t.push("השכונה היא שדה חובה"),e.get("price")||t.push("המחיר הוא שדה חובה"),e.get("size")||t.push("הגודל הוא שדה חובה"),e.get("business_type")||t.push("הסוג הוא שדה חובה"),e.get("monthly_yield")||t.push("שדה חובה"),e.get("contactSeller")||t.push("דרכי יצירת קשר עם המוכר הם שדה חובה"),e.get("address")||t.push("הכתובת היא שדה חובה"),t.length>0?console.log("Form validation failed:",t):console.log("Form validation passed."),x(t),0===t.length},N=async e=>{if(e.preventDefault(),p)return;h(!0),console.log("Form submission started...");let t=new FormData,l=e.target;if(t.append("city",l.city.value),t.append("neighborhood",l.neighborhood.value),t.append("price",l.price.value),t.append("size",l.size.value),t.append("business_type",l.business_type.value),t.append("monthly_yield",l.monthly_yield.value),t.append("propertyType","Business"),t.append("userId",d||""),t.append("contactSeller",l.contactSeller.value),t.append("address",l.address.value),f(t)){console.log("Submitting form data to the server...");let e=await fetch("/api/postProperty",{method:"POST",body:t}),l=await e.json();if(e.ok){console.log("Form submitted successfully:",l),alert("✅ נכס נקלט בהצלחה!");let e=localStorage.getItem("user");if(e){let t=JSON.parse(e);t.remainingListings=t.remainingListings-1,localStorage.setItem("user",JSON.stringify(t))}g.push("/")}else console.error("Error submitting form:",l.error),alert("Error: "+l.error)}h(!1)};return(0,s.jsxs)("form",{onSubmit:N,className:"bg-transparent p-6 rounded-lg shadow-lg max-w-lg mx-auto",children:[(0,s.jsx)("h2",{className:"text-3xl font-bold text-center text-gold-500 mb-6",children:"פרסום בית עסק"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col relative",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"עיר"}),(0,s.jsx)("input",{type:"text",value:l,onChange:e=>{let t=e.target.value;console.log("City input changed:",t),a(t),t?(console.log("Fetching cities for term:",t),b(t)):(console.log("Clearing city suggestions."),i([]))},name:"city",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"}),n.length>0&&(0,s.jsx)("ul",{className:"absolute bg-transparent text-gold border border-gold w-auto max-w-fit max-h-60 overflow-y-auto z-10 rounded-md mt-1 shadow-lg px-2 py-1 top-full left-0",children:n.map(e=>(0,s.jsx)("li",{onClick:()=>m(e),className:"cursor-pointer hover:bg-gray-700 p-3",children:e},e))})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"איזור/שכונה"}),(0,s.jsx)("input",{type:"text",name:"neighborhood",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"מחיר"}),(0,s.jsx)("input",{type:"number",name:"price",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:'מ"ר'}),(0,s.jsx)("input",{type:"number",name:"size",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"סוג הנכס"}),(0,s.jsx)("input",{type:"text",name:"business_type",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"תשואה חודשית"}),(0,s.jsx)("input",{type:"number",name:"monthly_yield",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"דרכי יצירת קשר עם המוכר"}),(0,s.jsx)("input",{type:"text",name:"contactSeller",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xl text-white",children:"כתובת"}),(0,s.jsx)("input",{type:"text",name:"address",required:!0,className:"p-2 rounded border-2 border-gold-500 bg-transparent text-white"})]}),(0,s.jsx)("button",{type:"submit",className:"bg-gold-500 text-black py-2 px-4 rounded-lg w-full hover:bg-gold-600",disabled:p,children:"שלח"})]})]})},u=()=>{let[e,t]=(0,r.useState)("Apartment"),l=(0,o.useRouter)(),{user:u}=(0,a.b)(),[x,p]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{(()=>{let e=localStorage.getItem("user"),t=e?JSON.parse(e):null;if(!t||!t.userId){localStorage.setItem("redirectAfterLogin",window.location.pathname),alert("משתמש לא מחובר, נא לבצע התחברות"),l.push("/login");return}if(0>=(t.remainingListings||0)){alert("אין יתרת פרסומים, מעביר לדף תשלום..."),l.push("/payment");return}p(!0)})()},[l]),x)?(0,s.jsxs)("div",{dir:"rtl",className:"bg-black bg-opacity-30 text-white p-8 rounded-lg shadow-xl max-w-lg mx-auto",children:[(0,s.jsx)("h2",{className:"text-3xl font-bold mb-6 text-center text-gold-300",children:"פרסום נכס"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"propertyType",className:"block text-sm font-medium mb-2 text-gold-300",children:"סוג נכס"}),(0,s.jsxs)("select",{id:"propertyType",value:e,onChange:e=>{t(e.target.value)},className:"bg-black bg-opacity-70 text-white p-3 rounded-md w-full focus:outline-none focus:ring focus:ring-gold-300",children:[(0,s.jsx)("option",{value:"Apartment",children:"דירה"}),(0,s.jsx)("option",{value:"Project",children:"פרויקט קבלן"}),(0,s.jsx)("option",{value:"Land",children:"קרקע"}),(0,s.jsx)("option",{value:"Business",children:"בית עסק"})]})]}),(()=>{switch(e){case"Apartment":default:return(0,s.jsx)(n,{});case"Project":return(0,s.jsx)(i,{});case"Land":return(0,s.jsx)(d,{});case"Business":return(0,s.jsx)(c,{})}})()]}):null}},99376:function(e,t,l){"use strict";var s=l(35475);l.o(s,"usePathname")&&l.d(t,{usePathname:function(){return s.usePathname}}),l.o(s,"useRouter")&&l.d(t,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[971,117,744],function(){return e(e.s=36773)}),_N_E=e.O()}]);