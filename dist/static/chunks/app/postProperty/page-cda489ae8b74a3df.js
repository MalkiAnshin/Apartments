(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[430],{6773:function(e,t,l){Promise.resolve().then(l.bind(l,8575))},1054:function(e,t,l){"use strict";l.d(t,{R:function(){return r},b:function(){return n}});var o=l(7437),s=l(2265);let a=(0,s.createContext)(void 0),r=e=>{let{children:t}=e,[l,r]=(0,s.useState)(null),[n,i]=(0,s.useState)(null),[c,u]=(0,s.useState)(null),[d,m]=(0,s.useState)(null);return(0,o.jsx)(a.Provider,{value:{user:l,setUser:r,userType:n,setUserType:i,userId:c,setUserId:u,firstListingFree:d,setFirstListingFree:m},children:t})},n=()=>{let e=(0,s.useContext)(a);if(!e)throw Error("useGlobalContext must be used within a GlobalProvider");return e}},8575:function(e,t,l){"use strict";l.r(t);var o=l(7437),s=l(2265),a=l(1054),r=l(9376);t.default=()=>{let[e,t]=(0,s.useState)(""),[l,n]=(0,s.useState)(""),[i,c]=(0,s.useState)(""),[u,d]=(0,s.useState)([]),[m,g]=(0,s.useState)(""),[p,h]=(0,s.useState)(""),[x,b]=(0,s.useState)([]),[f,y]=(0,s.useState)(!1),[j,v]=(0,s.useState)("Apartment"),[N,w]=(0,s.useState)(!1),[k,S]=(0,s.useState)(!1),[C,F]=(0,s.useState)(!1),[P,E]=(0,s.useState)(""),[_,R]=(0,s.useState)(""),[I,L]=(0,s.useState)(!1),[O,A]=(0,s.useState)(""),B=(0,r.useRouter)(),{user:T,userId:q,firstListingFree:D,setFirstListingFree:G}=(0,a.b)();(0,s.useEffect)(()=>{console.log(q),console.table(T),T?!0===D&&B.push("/payment"):(alert("משתמש לא מחובר נא לבצע התחברות"),B.push("/login"))},[]);let J=async e=>{try{let t=await fetch("https://data.gov.il/api/3/action/datastore_search?resource_id=d4901968-dad3-4845-a9b0-a57d027f11ab");if(!t.ok)throw Error("Network response was not ok");let l=await t.json();if(l.success&&l.result&&l.result.records){let t=l.result.records.map(e=>e["שם_ישוב"]).filter(t=>""!==t&&t.toLowerCase().includes(e.toLowerCase()));b(t)}}catch(e){console.error("Error fetching cities:",e)}},z=e=>{h(e),b([])},H=async t=>{if(t.preventDefault(),0>=Number(l)||0>=Number(i)){g("Price and Rooms must be positive numbers");return}if(D){B.push("/payment");return}let o=new FormData;o.append("neighborhood",e),o.append("price",l),o.append("rooms",i.toString()),o.append("city",p),o.append("propertyType",j),o.append("userId",(null==q?void 0:q.toString())||""),o.append("parking",N.toString()),o.append("warehouse",k.toString()),o.append("elevator",C.toString()),o.append("address",P),o.append("contactSeller",_),o.append("floor",O.toString()),o.append("hasBalcony",I.toString()),u.forEach(e=>{o.append("images",e)}),o.forEach((e,t)=>{console.log("".concat(t,": ").concat(e))}),y(!0);try{let e=await fetch("/api/postProperty",{method:"POST",body:o}),t=await e.json();if(e.ok){g("Property added successfully! Property ID: ".concat(t.propertyId)),K(),B.push("/");let e=localStorage.getItem("user");if(e){let t=JSON.parse(e);t.firstListingFree=!0,localStorage.setItem("user",JSON.stringify(t))}G(!0)}else g("Error: ".concat(t.error))}catch(e){g("Error submitting property")}finally{y(!1)}},K=()=>{t(""),n(""),c(""),d([]),g(""),h(""),v("Apartment"),w(!1),S(!1),F(!1),E(""),R(""),A(""),L(!1)};return(0,o.jsxs)("div",{dir:"rtl",className:"bg-black bg-opacity-30 text-white p-8 rounded-lg shadow-xl max-w-lg mx-auto",children:[(0,o.jsx)("h2",{className:"text-3xl font-bold mb-6 text-center text-gold-300",children:"פרסום נכס"}),(0,o.jsxs)("form",{onSubmit:H,className:"space-y-6",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"propertyType",className:"block text-sm font-medium mb-2 text-gold-300",children:"סוג נכס"}),(0,o.jsxs)("select",{id:"propertyType",value:j,onChange:e=>v(e.target.value),className:"bg-black bg-opacity-70 text-white p-3 rounded-md w-full focus:outline-none focus:ring focus:ring-gold-300",children:[(0,o.jsx)("option",{value:"Apartment",children:"דירה"}),(0,o.jsx)("option",{value:"Project",children:"פרויקט קבלן"}),(0,o.jsx)("option",{value:"Land",children:"קרקע"}),(0,o.jsx)("option",{value:"Business",children:"בית עסק"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"city",className:"block text-sm font-medium mb-2 text-gold-300",children:"עיר"}),(0,o.jsx)("input",{type:"text",id:"city",value:p,onChange:e=>{let t=e.target.value;h(t),t?J(t):b([])},className:"bg-black bg-opacity-70 text-white p-3 rounded-md w-full focus:outline-none focus:ring focus:ring-gold-300",placeholder:"הקלד שם עיר"}),x.length>0&&(0,o.jsx)("ul",{className:"absolute bg-gray-800 text-white border border-gray-600 w-full max-h-60 overflow-y-auto z-10 rounded-md mt-1",children:x.map(e=>(0,o.jsx)("li",{onClick:()=>z(e),className:"cursor-pointer hover:bg-gray-700 p-3",children:e},e))})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"neighborhood",className:"block text-sm font-medium mb-2 text-gold-300",children:"שכונה/איזור"}),(0,o.jsx)("input",{type:"text",id:"neighborhood",value:e,onChange:e=>t(e.target.value),className:"bg-black bg-opacity-70 text-white p-3 rounded-md w-full focus:outline-none focus:ring focus:ring-gold-300",required:!0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium mb-2 text-gold-300",children:"מחיר"}),(0,o.jsx)("input",{type:"number",id:"price",value:l,onChange:e=>n(e.target.value),className:"bg-black bg-opacity-70 text-white p-3 rounded-md w-full focus:outline-none focus:ring focus:ring-gold-300",required:!0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"rooms",className:"block text-sm font-medium mb-2 text-gold-300",children:"מספר חדרים"}),(0,o.jsx)("input",{type:"number",id:"rooms",value:i,onChange:e=>c(e.target.value),className:"bg-black bg-opacity-70 text-white p-3 rounded-md w-full focus:outline-none focus:ring focus:ring-gold-300",required:!0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"floor",className:"block text-sm font-medium mb-2 text-gold-300",children:"קומה"}),(0,o.jsx)("input",{type:"number",id:"floor",value:O,onChange:e=>A(e.target.value),className:"bg-black bg-opacity-70 text-white p-3 rounded-md w-full focus:outline-none focus:ring focus:ring-gold-300"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"address",className:"block text-sm font-medium mb-2 text-gold-300",children:"כתובת"}),(0,o.jsx)("input",{type:"text",id:"address",value:P,onChange:e=>E(e.target.value),className:"bg-black bg-opacity-70 text-white p-3 rounded-md w-full focus:outline-none focus:ring focus:ring-gold-300"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"contactSeller",className:"block text-sm font-medium mb-2 text-gold-300",children:"דרכי יצירת קשר עם המוכר"}),(0,o.jsx)("input",{type:"text",id:"contactSeller",value:_,onChange:e=>R(e.target.value),className:"bg-black bg-opacity-70 text-white p-3 rounded-md w-full focus:outline-none focus:ring focus:ring-gold-300"})]}),(0,o.jsxs)("div",{className:"flex items-center mb-4",children:[(0,o.jsx)("label",{htmlFor:"hasBalcony",className:"text-gold-300",children:"מרפסת"}),(0,o.jsx)("input",{type:"checkbox",id:"hasBalcony",checked:I,onChange:()=>L(!I),className:"ml-2 text-gold-300 focus:ring focus:ring-gold-300"})]}),(0,o.jsxs)("div",{className:"flex items-center mb-4",children:[(0,o.jsx)("label",{htmlFor:"parking",className:"text-gold-300",children:"חניה"}),(0,o.jsx)("input",{type:"checkbox",id:"parking",checked:N,onChange:()=>w(!N),className:"ml-2 text-gold-300 focus:ring focus:ring-gold-300"})]}),(0,o.jsxs)("div",{className:"flex items-center mb-4",children:[(0,o.jsx)("label",{htmlFor:"warehouse",className:"text-gold-300",children:"מחסן"}),(0,o.jsx)("input",{type:"checkbox",id:"warehouse",checked:k,onChange:()=>S(!k),className:"ml-2 text-gold-300 focus:ring focus:ring-gold-300"})]}),(0,o.jsxs)("div",{className:"flex items-center mb-4",children:[(0,o.jsx)("label",{htmlFor:"elevator",className:"text-gold-300",children:"מעלית"}),(0,o.jsx)("input",{type:"checkbox",id:"elevator",checked:C,onChange:()=>F(!C),className:"ml-2 text-gold-300 focus:ring focus:ring-gold-300"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"images",className:"block text-sm font-medium mb-2 text-gold-300",children:"העלת תמונות מהנכס"}),(0,o.jsx)("input",{type:"file",id:"images",multiple:!0,onChange:e=>{e.target.files&&d(Array.from(e.target.files))},className:"bg-black bg-opacity-70 text-white p-3 rounded-md w-full focus:outline-none focus:ring focus:ring-gold-300"})]}),(0,o.jsx)("button",{type:"submit",className:"bg-blue-500 text-white py-2 rounded-md w-full ".concat(f?"opacity-50 cursor-not-allowed":""),disabled:f,children:f?"Loading...":"הוסף נכס"}),m&&(0,o.jsx)("p",{className:"text-red-500",children:m})]})]})}},9376:function(e,t,l){"use strict";var o=l(5475);l.o(o,"usePathname")&&l.d(t,{usePathname:function(){return o.usePathname}}),l.o(o,"useRouter")&&l.d(t,{useRouter:function(){return o.useRouter}})}},function(e){e.O(0,[971,117,744],function(){return e(e.s=6773)}),_N_E=e.O()}]);