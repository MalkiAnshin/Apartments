(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[505],{6773:function(e,t,r){Promise.resolve().then(r.bind(r,8575))},1054:function(e,t,r){"use strict";r.d(t,{R:function(){return n},b:function(){return o}});var a=r(7437),s=r(2265);let l=(0,s.createContext)(void 0),n=e=>{let{children:t}=e,[r,n]=(0,s.useState)(null),[o,i]=(0,s.useState)(null),[c,d]=(0,s.useState)(null),[u,p]=(0,s.useState)(null);return(0,a.jsx)(l.Provider,{value:{user:r,setUser:n,userType:o,setUserType:i,userId:c,setUserId:d,firstListingFree:u,setFirstListingFree:p},children:t})},o=()=>{let e=(0,s.useContext)(l);if(!e)throw Error("useGlobalContext must be used within a GlobalProvider");return e}},8575:function(e,t,r){"use strict";r.r(t);var a=r(7437),s=r(2265),l=r(1054),n=r(9376);t.default=()=>{let[e,t]=(0,s.useState)(""),[r,o]=(0,s.useState)(""),[i,c]=(0,s.useState)(""),[d,u]=(0,s.useState)([]),[p,h]=(0,s.useState)(""),[m,b]=(0,s.useState)(""),[g,x]=(0,s.useState)([]),[y,f]=(0,s.useState)(!1),[j,v]=(0,s.useState)("Apartment"),[N,S]=(0,s.useState)(!1),[w,k]=(0,s.useState)(!1),[C,P]=(0,s.useState)(!1),[F,E]=(0,s.useState)(""),[_,A]=(0,s.useState)(""),[R,B]=(0,s.useState)(!1),[I,L]=(0,s.useState)(""),O=(0,n.useRouter)(),{user:T,userId:q,firstListingFree:D,setFirstListingFree:G}=(0,l.b)();(0,s.useEffect)(()=>{T?!0===D&&O.push("/payment"):(alert("משתמש לא מחובר נא לבצע התחברות"),O.push("/login"))},[]);let J=async e=>{try{let t=await fetch("https://data.gov.il/api/3/action/datastore_search?resource_id=d4901968-dad3-4845-a9b0-a57d027f11ab");if(!t.ok)throw Error("Network response was not ok");let r=await t.json();if(r.success&&r.result&&r.result.records){let t=r.result.records.map(e=>e["שם_ישוב"]).filter(t=>""!==t&&t.toLowerCase().includes(e.toLowerCase()));x(t)}}catch(e){console.error("Error fetching cities:",e)}},z=e=>{b(e),x([])},H=async t=>{if(t.preventDefault(),console.log("user id :::::::::::::::::::".concat(q)),0>=Number(r)||0>=Number(i)){h("Price and Rooms must be positive numbers");return}if(D){O.push("/payment");return}let a=new FormData;a.append("neighborhood",e),a.append("price",r),a.append("rooms",i.toString()),a.append("city",m),a.append("propertyType",j),a.append("userId",(null==q?void 0:q.toString())||""),a.append("parking",N.toString()),a.append("warehouse",w.toString()),a.append("elevator",C.toString()),a.append("address",F),a.append("contactSeller",_),a.append("floor",I.toString()),a.append("hasBalcony",R.toString()),d.forEach(e=>{a.append("images",e)}),f(!0);try{let e=await fetch("/api/postProperty",{method:"POST",body:a}),t=await e.json();if(e.ok){h("Property added successfully! Property ID: ".concat(t.propertyId)),U(),O.push("/");let e=localStorage.getItem("user");if(e){let t=JSON.parse(e);t.firstListingFree=!0,localStorage.setItem("user",JSON.stringify(t))}G(!0)}else h("Error: ".concat(t.error))}catch(e){h("Error submitting property")}finally{f(!1)}},U=()=>{t(""),o(""),c(""),u([]),h(""),b(""),v("Apartment"),S(!1),k(!1),P(!1),E(""),A(""),L(""),B(!1)};return(0,a.jsxs)("div",{className:"bg-gray-800 text-white p-6 rounded-md relative",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Add New Property"}),(0,a.jsxs)("form",{onSubmit:H,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"propertyType",className:"block mb-2",children:"Property Type"}),(0,a.jsxs)("select",{id:"propertyType",value:j,onChange:e=>v(e.target.value),className:"bg-gray-700 p-2 rounded-md w-full",children:[(0,a.jsx)("option",{value:"Apartment",children:"Apartment"}),(0,a.jsx)("option",{value:"Project",children:"Project"}),(0,a.jsx)("option",{value:"Land",children:"Land"}),(0,a.jsx)("option",{value:"Business",children:"Business"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"city",className:"block mb-2",children:"City"}),(0,a.jsx)("input",{type:"text",id:"city",value:m,onChange:e=>{let t=e.target.value;b(t),t?J(t):x([])},className:"bg-gray-700 p-2 rounded-md w-full",placeholder:"Choose a city"}),g.length>0&&(0,a.jsx)("ul",{className:"absolute bg-gray-600 text-white border border-gray-500 w-full max-h-60 overflow-y-auto z-10",children:g.map(e=>(0,a.jsx)("li",{onClick:()=>z(e),className:"cursor-pointer hover:bg-gray-500 p-2",children:e},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"neighborhood",className:"block mb-2",children:"Neighborhood"}),(0,a.jsx)("input",{type:"text",id:"neighborhood",value:e,onChange:e=>t(e.target.value),className:"bg-gray-700 p-2 rounded-md w-full",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"price",className:"block mb-2",children:"Price"}),(0,a.jsx)("input",{type:"number",id:"price",value:r,onChange:e=>o(e.target.value),className:"bg-gray-700 p-2 rounded-md w-full",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"rooms",className:"block mb-2",children:"Rooms"}),(0,a.jsx)("input",{type:"number",id:"rooms",value:i,onChange:e=>c(e.target.value),className:"bg-gray-700 p-2 rounded-md w-full",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"floor",className:"block mb-2",children:"Floor"}),(0,a.jsx)("input",{type:"number",id:"floor",value:I,onChange:e=>L(e.target.value),className:"bg-gray-700 p-2 rounded-md w-full"})]}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{htmlFor:"hasBalcony",className:"flex items-center mb-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"hasBalcony",checked:R,onChange:()=>B(!R),className:"mr-2"}),"Has Balcony"]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"address",className:"block mb-2",children:"Address"}),(0,a.jsx)("input",{type:"text",id:"address",value:F,onChange:e=>E(e.target.value),className:"bg-gray-700 p-2 rounded-md w-full"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"contactSeller",className:"block mb-2",children:"Contact Seller"}),(0,a.jsx)("input",{type:"text",id:"contactSeller",value:_,onChange:e=>A(e.target.value),className:"bg-gray-700 p-2 rounded-md w-full"})]}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{htmlFor:"parking",className:"flex items-center mb-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"parking",checked:N,onChange:()=>S(!N),className:"mr-2"}),"Parking"]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{htmlFor:"warehouse",className:"flex items-center mb-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"warehouse",checked:w,onChange:()=>k(!w),className:"mr-2"}),"Warehouse"]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{htmlFor:"elevator",className:"flex items-center mb-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"elevator",checked:C,onChange:()=>P(!C),className:"mr-2"}),"Elevator"]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"images",className:"block mb-2",children:"Upload Images"}),(0,a.jsx)("input",{type:"file",id:"images",multiple:!0,onChange:e=>{e.target.files&&u(Array.from(e.target.files))},className:"bg-gray-700 p-2 rounded-md w-full"})]}),(0,a.jsx)("button",{type:"submit",className:"bg-blue-500 text-white py-2 rounded-md w-full ".concat(y?"opacity-50 cursor-not-allowed":""),disabled:y,children:y?"Loading...":"Add Property"}),p&&(0,a.jsx)("p",{className:"text-red-500",children:p})]})]})}},9376:function(e,t,r){"use strict";var a=r(5475);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})}},function(e){e.O(0,[971,117,744],function(){return e(e.s=6773)}),_N_E=e.O()}]);