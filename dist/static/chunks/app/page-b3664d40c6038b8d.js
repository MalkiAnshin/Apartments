(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{12885:function(e,t,r){Promise.resolve().then(r.bind(r,66392))},81054:function(e,t,r){"use strict";r.d(t,{R:function(){return o},b:function(){return n}});var s=r(57437),l=r(2265);let a=(0,l.createContext)(void 0),o=e=>{let{children:t}=e,[r,o]=(0,l.useState)(null),[n,i]=(0,l.useState)(null),[c,d]=(0,l.useState)(null),[m,x]=(0,l.useState)(null);return(0,s.jsx)(a.Provider,{value:{user:r,setUser:o,userType:n,setUserType:i,userId:c,setUserId:d,remainingListings:m,setRemainingListings:x},children:t})},n=()=>{let e=(0,l.useContext)(a);if(!e)throw Error("useGlobalContext must be used within a GlobalProvider");return e}},66392:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return v}});var s=r(57437),l=r(2265),a=r(99376),o=r(87938),n=r.n(o),i=r(24457),c=r.n(i),d=r(53375),m=e=>{let{selectedProperty:t,property_type:r,onClose:a}=e,[o,i]=(0,l.useState)(null),[m,x]=(0,l.useState)(""),[u,p]=(0,l.useState)(""),[h,g]=(0,l.useState)(""),[f,j]=(0,l.useState)(null),[b,y]=(0,l.useState)(null),[N,w]=(0,l.useState)(""),S=t.property_id,v=(0,l.useRef)(null),k=(0,l.useRef)(null),E=localStorage.getItem("user"),_=E?JSON.parse(E).userId:null;(0,l.useEffect)(()=>{p(new Date().toISOString().split("T")[0])},[]);let P=async()=>{if(!N||!o||!m||!u||!r||!S||!h||!f){alert("אנא מלא את כל השדות.");return}if(N!=_){var e;console.log("idNum: ".concat(N," userId: ").concat(_)),alert("מספר זהות לא נכון!"),null===(e=document.querySelector('input[value="'+N+'"]'))||void 0===e||e.focus();return}if(k.current)try{let e=(await c()(k.current)).toDataURL("image/png"),t=new d.ZP;t.addImage(e,"PNG",10,10,180,0);let s=t.output("blob"),l=new FormData;l.append("idNum",N),l.append("signature",o),l.append("name",m),l.append("signed_date",u),l.append("property_type",r),l.append("property_id",S),l.append("notes",h),l.append("userId",_||""),l.append("pdf",s,"contract.pdf"),l.append("image",f);let n=await fetch("/api/saveContract",{method:"POST",body:l});if(n.ok)alert("החוזה נשמר בהצלחה!"),a();else{let e=await n.text();console.error("Server Error:",e),alert("שגיאה: ".concat(n.status," - ").concat(e))}}catch(e){console.error("Network Error:",e),alert("שגיאה בתקשורת לשרת. נסי שוב.")}};return(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center overflow-y-auto z-50",children:(0,s.jsxs)("div",{ref:k,className:"bg-white text-black p-6 rounded-lg w-full max-w-3xl mx-4 sm:mx-6 lg:max-w-4xl max-h-screen overflow-auto",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"חתום על החוזה"}),(0,s.jsx)("p",{className:"text-base mb-2",children:"טופס הזמנת שירותי תיווך בלעדיים למכירת/השכרת נכס מקרקעין 0014"}),(0,s.jsx)("p",{className:"text-sm mb-2",children:'(בהתאם ל"חוק המתווכים במקרקעין, התשנ"ז 1996")'}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"סעיפים:"}),(0,s.jsx)("li",{children:'הלקוח מזמין מהמתווח שירותי תיווך מקרקעין, כדי לקבל שירותי תיווך בקשר לנכסים המפורטים להלן עבורנו ועבור (להלן "שולחו")'}),(0,s.jsx)("li",{children:'הלקוחות מאשרים כי המתווך הציג בפניהם את הנכסים המפורטים להלן, והם מתחייבים לדווח ל "שילת נכסים" מיד על משא ומתן המתנהל עמם בקשר לאחד או יותר מהנכסים, וכן מיד עם חתימת הסכם מחייב ו/או עם התחייבות לביצוע העסקה, המוקדם ביניהם, ביחס לאחד או יותר מהנכסים להלן'}),(0,s.jsx)("li",{children:'הלקוחות מתחייבים לשלם ל "שילת נכסים" דמי תיווך בשיעור המפורט להלן בסעיף 5 מיד עם חתימת הסכם מחייב ו/או עם התחייבות לביצוע העסקה, המוקדם ביניהם, בנוגע לאחד או יותר מהנכסים המפורטים להלן, עמנו או עם מי מטעמנו, או עם כל גוף שאנו או מי מיטעמנו קשור אליו, או עם כל מי שמסרנו פרטים בקשר לנכסים'}),(0,s.jsx)("li",{children:'הקונים מתחייבים לא למסור לגורם כלשהוא מידע שיקבלו מ "שילת נכסים" בנוגע לנכסים שלהלן, והם מתחייבים לפצות את "שילת נכסים" על כל נזק שיגרם להם באם יפרו התחייבות זו.'}),(0,s.jsxs)("li",{children:['דמי התיווך ישולמו ל "שילת נכסים" כמפורט בסעיף 3 לעיל ויהיו כדלקמן:',(0,s.jsxs)("ul",{className:"list-disc list-inside pl-4",children:[(0,s.jsx)("li",{children:'בקניה: 2% בתוספת מע"מ ממחיר המכירה הכולל של הנכס אך לא פחות מ- 10,000 ₪ בתוספת מע"מ.'}),(0,s.jsx)("li",{children:'בשכירות: דמי שכירות של חודש אחד בתוספת מע"מ.'}),(0,s.jsx)("li",{children:'האמור לעיל בא בנוסף לזכותה של שילת אורם – "שילת נכסים" לנכות דמי תיווך מהמוכר/משכיר.'}),(0,s.jsx)("li",{children:'כאמור דמי התיווך ישולמו מיד עם חתימת הסכם מחייב ו/או עם התחייבות לביצוע העסקה המוקדם מבניהם. כל תשלום אשר לא יעשה בתוך שלושה ימים ממועד זה ישא הצמדה וריבית כנהוג בחשבונות עו"ש מהיום לתשלום ועד יום פירעון התשלום בפועל.'}),(0,s.jsx)("li",{children:'הלקוח מצהיר כי ידוע לו שדמי התיווך יגבו על ידי "בת שבע נדל"ן" וכנגד חשבוניות מס כחוק מטעם "שילת נכסים".'})]})]}),(0,s.jsx)("li",{children:'הלקוח מאשר שהומלץ לו ע"י המתווך להסתייע בשירותי עורך דין ו/או מומחים אחראים לפי הענין והצורך במהלך העסקה.'}),(0,s.jsxs)("div",{className:"my-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"שם מלא"}),(0,s.jsx)("input",{type:"text",value:m,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border rounded"})]}),(0,s.jsxs)("div",{className:"my-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"מספר זהות"}),(0,s.jsx)("input",{type:"text",value:N,onChange:e=>w(e.target.value),className:"w-full px-3 py-2 border rounded"})]}),(0,s.jsx)("label",{className:"block mb-1",children:"תאריך:"}),(0,s.jsx)("input",{type:"date",value:u,onChange:e=>p(e.target.value),className:"border rounded w-full p-2"}),(0,s.jsxs)("div",{className:"my-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"הערות"}),(0,s.jsx)("textarea",{value:h,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border rounded"})]}),(0,s.jsxs)("div",{className:"my-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"חתימה"}),(0,s.jsx)(n(),{ref:v,onEnd:()=>{v.current&&i(v.current.toDataURL())},canvasProps:{width:500,height:200,className:"border"}})]}),(0,s.jsxs)("div",{className:"my-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("img",{width:"30",height:"30",src:"https://img.icons8.com/ios/50/insert-page.png",alt:"insert-page"}),(0,s.jsx)("label",{className:"block text-sm font-medium",children:"העלה צילום תעודת זהות"})]}),(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{if(e.target.files&&e.target.files[0]){let t=e.target.files[0];j(t);let r=new FileReader;r.onloadend=()=>{y(r.result)},r.readAsDataURL(t)}},className:"w-full mt-2 px-3 py-2 border rounded"})]}),(0,s.jsxs)("div",{className:"flex justify-between mt-6",children:[(0,s.jsx)("button",{onClick:a,className:"bg-gray-300 text-black py-2 px-4 rounded",children:"סגור"}),(0,s.jsx)("button",{onClick:P,className:"bg-black text-white py-2 px-4 rounded",children:"שלח וחתום"})]})]})})},x=e=>{let{property_id:t}=e,[r,a]=(0,l.useState)([]),[o,n]=(0,l.useState)(0),[i,c]=(0,l.useState)(null);return((0,l.useEffect)(()=>{console.log("ApartmentImages useEffect running, property_id:",t);let e=async()=>{try{console.log("Fetching images from /api/apartmentsPictures with property_id:",t);let e=await fetch("/api/apartmentsPictures",{method:"GET",headers:{property_id:t.toString()}});if(console.log("Fetch response status:",e.status,e.statusText),!e.ok)throw Error("Network response was not ok: ".concat(e.statusText));let r=await e.json();console.log("Data received from API:",r),a(r.images||[])}catch(e){c("Error fetching images: ".concat(e.message)),console.error("Error fetching images:",e)}};t&&e()},[t]),r.length>0&&console.log("Rendering image:",r[o]),i)?(0,s.jsxs)("div",{children:["Error loading images: ",i]}):(0,s.jsxs)("div",{className:"relative w-full h-64 md:h-96",children:[r.length>0?(0,s.jsx)("img",{src:r[o],alt:"Apartment ".concat(t," - Image ").concat(o+1),className:"w-full h-full object-cover rounded-md"}):(0,s.jsx)("p",{children:"אין תמונות זמינות"}),r.length>1&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>{n(e=>(e-1+r.length)%r.length)},className:"absolute left-0 top-1/2 transform -translate-y-1/2 text-gray-600 text-3xl md:text-4xl",children:"◀"}),(0,s.jsx)("button",{onClick:()=>{n(e=>(e+1)%r.length)},className:"absolute right-0 top-1/2 transform -translate-y-1/2 text-gray-600 text-3xl md:text-4xl",children:"▶"})]})]})},u=r(86047),p=r(3339),h=()=>{let[e,t]=(0,l.useState)([]),[r,o]=(0,l.useState)(null),[n,i]=(0,l.useState)(!1),[c,d]=(0,l.useState)(null),[h,g]=(0,l.useState)({}),[f,j]=(0,l.useState)(null),[b,y]=(0,l.useState)(!1),[N,w]=(0,l.useState)(!1),S=localStorage.getItem("user"),v=S?JSON.parse(S).userId:null,k=(0,a.useRouter)();(0,l.useEffect)(()=>{let e=async()=>{let e=new URLSearchParams;c&&e.append("city",c),h.minPrice&&e.append("minPrice",h.minPrice.toString()),h.maxPrice&&e.append("maxPrice",h.maxPrice.toString()),h.rooms&&e.append("rooms",h.rooms);try{let r=await fetch("/api/apartments?".concat(e.toString()));if(!r.ok)throw Error("Failed to fetch data, status: ".concat(r.status));let s=await r.json();t(s)}catch(e){console.error("Error fetching apartments:",e),j("Error fetching apartments")}};c&&e()},[c,h]);let E=e=>{v||(localStorage.setItem("redirectAfterLogin",window.location.pathname),k.push("/login")),w(!0),P(e.property_id,"apartment"),o(e)},_=()=>{i(!1),o(null)},P=async(e,t)=>{let r=JSON.parse(localStorage.getItem("user")||"{}").userId||null;if(!r){localStorage.setItem("redirectAfterLogin",window.location.pathname),k.push("/login");return}try{let s=await fetch("/api/moreDetailsApartments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apartmentId:e,userId:r,propertyType:t})});if(!s.ok)throw Error("Network response was not ok");(await s.json()).exists?o(e=>({...e,moreDetails:!0})):i(!0),y(!0),w(!1)}catch(e){j("Error checking contract: ".concat(e instanceof Error?e.message:"An unknown error occurred")),w(!1)}};return(0,s.jsxs)("div",{className:"text-white min-h-screen flex flex-col items-center p-6 rtl",children:[(0,s.jsxs)("div",{className:"w-full max-w-4xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6 text-gold text-center",children:"מצא את הדירה המתאימה"}),(0,s.jsx)(u.Z,{onCitySelect:d}),c&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.Z,{onPriceChange:e=>{g(t=>({...t,minPrice:e.min,maxPrice:e.max}))},onRoomsChange:e=>{g(t=>({...t,rooms:e.toString()}))}}),(0,s.jsxs)("h2",{className:"text-2xl font-semibold mb-4 text-gold text-center",children:["דירות ב",c]}),e.length>0?(0,s.jsx)("ul",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(e=>(0,s.jsxs)("li",{className:"bg-gray-800 p-4 rounded-lg border border-gold cursor-pointer rtl",children:[(0,s.jsxs)("p",{className:"text-lg font-medium",children:["שכונה/איזור: ",e.neighborhood]}),"// ...existing code...",(0,s.jsxs)("p",{className:"text-lg text-gray-800",children:["מחיר: ",Number(e.price).toLocaleString("he-IL",{maximumFractionDigits:0})," ₪"]}),"// ...existing code...                    ",(0,s.jsxs)("p",{className:"text-sm",children:["חדרים: ",e.rooms]}),(0,s.jsx)(x,{property_id:e.property_id}),(0,s.jsx)("button",{className:"mt-4 bg-gold text-black px-6 py-2 rounded-md font-semibold",onClick:()=>E(e),disabled:N,children:N?"בודק...":"פרטים נוספים"}),b&&(null==r?void 0:r.property_id)===e.property_id&&!n&&(0,s.jsxs)("div",{className:"mt-4 text-gold",children:[(0,s.jsxs)("p",{children:["כתובת: ",e.address]}),(0,s.jsxs)("p",{children:["פרטי יצירת קשר: ",e.contact_seller]})]}),n&&(null==r?void 0:r.property_id)===e.property_id&&(0,s.jsx)(m,{selectedProperty:r,property_type:"apartment",onClose:_})]},e.property_id))}):(0,s.jsx)("p",{className:"text-center text-xl text-gray-400 mt-4",children:"לא נמצאו דירות מתאימות."})]})]}),f&&(0,s.jsx)("div",{className:"text-red-600 text-center mt-4",children:f})]})},g=e=>{let{onSelect:t}=e;return(0,s.jsxs)("div",{className:"flex flex-col items-center mb-6 w-full max-w-4xl mx-auto",children:[(0,s.jsx)("label",{className:"block text-lg font-semibold mb-2 text-gold text-center",children:"בחר סוג נכס:"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-4 justify-center w-full",children:["פרויקט קבלן","בתי עסק","קרקעות","דירות"].map(e=>(0,s.jsx)("button",{onClick:()=>{t(e)},className:"flex-1 min-w-[120px] py-3 px-6 text-center rounded-lg border border-gold bg-black text-gold shadow-lg hover:bg-gray-800 transition-colors duration-300 text-lg md:text-xl",children:e},e))})]})},f=()=>{let[e,t]=(0,l.useState)([]),[r,o]=(0,l.useState)(null),[n,i]=(0,l.useState)(!1),[c,d]=(0,l.useState)(null),[x,p]=(0,l.useState)(null),h=localStorage.getItem("user"),g=h?JSON.parse(h).userId:null,f=(0,a.useRouter)();(0,l.useEffect)(()=>{let e=async()=>{let e=new URLSearchParams;c&&e.append("city",c);try{let r=await fetch("/api/lands?".concat(e.toString()));if(!r.ok)throw Error("Failed to fetch data, status: ".concat(r.status));let s=await r.json();t(s),console.log(s)}catch(e){console.error("Error fetching lands:",e),p("Error fetching lands")}};c&&e()},[c]);let j=e=>{g||(localStorage.setItem("redirectAfterLogin",window.location.pathname),f.push("/login")),y(e.property_id,"land"),o(e)},b=()=>{i(!1),o(null)},y=async(e,t)=>{let r=JSON.parse(localStorage.getItem("user")||"{}").userId||null;if(!r){localStorage.setItem("redirectAfterLogin",window.location.pathname),f.push("/login");return}try{let s=await fetch("/api/moreDetailsLands",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({landId:e,userId:r,propertyType:t})});if(!s.ok)throw Error("Network response was not ok");let l=await s.json();console.log("Received data: ",l),l.exists?o(e=>({...e,moreDetails:!0,additionalDetails:l.additionalDetails})):i(!0)}catch(e){p("Error checking contract: ".concat(e instanceof Error?e.message:"An unknown error occurred"))}};return(0,s.jsxs)("div",{className:"text-white min-h-screen flex flex-col items-center p-6 rtl",children:[(0,s.jsxs)("div",{className:"w-full max-w-4xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6 text-gold text-center",children:"מצא את הקרקע המתאימה"}),(0,s.jsx)(u.Z,{onCitySelect:d}),c&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("h2",{className:"text-2xl font-semibold mb-4 text-gold text-center",children:["קרקעות ב",c]}),e.length>0?(0,s.jsx)("ul",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(e=>(0,s.jsxs)("li",{className:"bg-gray-800 p-4 rounded-lg border border-gold cursor-pointer rtl",children:[(0,s.jsxs)("p",{className:"text-lg font-medium",children:["שכונה/איזור: ",e.neighborhood]}),(0,s.jsxs)("p",{className:"text-md text-gold",children:["מחיר: ",Number(e.price).toLocaleString("he-IL",{maximumFractionDigits:0}),' ש"ח']}),(0,s.jsxs)("p",{className:"text-sm",children:["גודל: ",e.size,' מ"ר']}),(0,s.jsx)("p",{className:"text-sm",children:e.buildable_area?"השטח בנוי":"השטח אינו בנוי"}),(0,s.jsx)("button",{className:"mt-4 bg-gold text-black px-6 py-2 rounded-md font-semibold",onClick:()=>j(e),children:"לפרטים נוספים"}),n&&(null==r?void 0:r.property_id)===e.property_id&&(0,s.jsx)(m,{selectedProperty:r,property_type:"land",onClose:b}),(null==r?void 0:r.property_id)===e.property_id&&!n&&r.moreDetails&&(0,s.jsxs)("div",{className:"mt-4 text-gold",children:[(0,s.jsxs)("p",{children:["כתובת: ",e.address]}),(0,s.jsxs)("p",{children:["פרטי יצירת קשר: ",e.contact_info]})]})]},e.property_id))}):(0,s.jsx)("p",{className:"text-center text-xl text-gray-400 mt-4",children:"לא נמצאו קרקעות מתאימות."})]})]}),x&&(0,s.jsx)("div",{className:"text-red-600 text-center mt-4",children:x})]})},j=()=>{let[e,t]=(0,l.useState)([]),[r,o]=(0,l.useState)(null),[n,i]=(0,l.useState)(!1),[c,d]=(0,l.useState)(null),[x,p]=(0,l.useState)(null),h=(0,a.useRouter)();(0,l.useEffect)(()=>{let e=async()=>{let e=new URLSearchParams;c&&e.append("city",c);try{let r=await fetch("/api/business?".concat(e.toString()));if(!r.ok)throw Error("Failed to fetch data, status: ".concat(r.status));let s=await r.json();t(s)}catch(e){console.error("Error fetching business:",e),p("Error fetching business")}};c&&e()},[c]);let g=e=>{let t=localStorage.getItem("user");if(!(t?JSON.parse(t).userId:null)){localStorage.setItem("redirectAfterLogin",window.location.pathname),h.push("/login");return}j(e.property_id,"business"),o(e)},f=()=>{i(!1),o(null)},j=async(e,t)=>{let r=JSON.parse(localStorage.getItem("user")||"{}").userId||null;if(!r){localStorage.setItem("redirectAfterLogin",window.location.pathname),h.push("/login");return}try{let s=await fetch("/api/moreDetailsBusiness",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({property_id:e,userId:r,property_type:t})});if(!s.ok){let e=await s.json();throw console.error("Error response from server:",e),Error("Network response was not ok: ".concat(s.status))}let l=await s.json();l.exists?o(e=>({...e,moreDetails:!0,additionalDetails:l.additionalDetails})):i(!0)}catch(e){p("Error checking contract: ".concat(e instanceof Error?e.message:"An unknown error occurred")),console.error("Error checking contract:",e)}};return(0,s.jsxs)("div",{className:"text-white min-h-screen flex flex-col items-center p-6 rtl",children:[(0,s.jsxs)("div",{className:"w-full max-w-4xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6 text-gold text-center",children:"מצא את העסק המתאים"}),(0,s.jsx)(u.Z,{onCitySelect:d}),c&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("h2",{className:"text-2xl font-semibold mb-4 text-gold text-center",children:["בתי עסק ב",c]}),e.length>0?(0,s.jsx)("ul",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map((e,t)=>(0,s.jsxs)("li",{className:"bg-gray-800 p-4 rounded-lg border border-gold cursor-pointer rtl",children:[(0,s.jsxs)("p",{className:"text-lg font-medium",children:["שכונה/איזור: ",e.neighborhood]}),(0,s.jsxs)("p",{className:"text-md text-gold",children:["מחיר: ",Number(e.price).toLocaleString("he-IL",{maximumFractionDigits:0}),' ש"ח']}),(0,s.jsxs)("p",{className:"text-sm",children:["סוג נכס: ",e.business_type]}),(0,s.jsxs)("p",{className:"text-sm",children:["תשואה חודשית: ",e.monthly_yield,' ש"ח']}),(0,s.jsx)("button",{className:"mt-4 bg-gold text-black px-6 py-2 rounded-md font-semibold",onClick:()=>g(e),children:"לפרטים נוספים"}),n&&(null==r?void 0:r.property_id)===e.property_id&&(0,s.jsx)(m,{selectedProperty:r,property_type:"business",onClose:f}),(null==r?void 0:r.property_id)===e.property_id&&!n&&(null==r?void 0:r.moreDetails)&&(0,s.jsxs)("div",{className:"mt-4 text-gold",children:[(0,s.jsxs)("p",{children:["כתובת: ",e.address]}),(0,s.jsxs)("p",{children:["פרטי יצירת קשר: ",e.contact_info]})]})]},"".concat(e.property_id,"-").concat(t)))}):(0,s.jsx)("p",{className:"text-center text-xl text-gray-400 mt-4",children:"לא נמצאו בתי עסק מתאימים."})]})]}),x&&(0,s.jsx)("div",{className:"text-red-600 text-center mt-4",children:x})]})},b=e=>{let{property_id:t}=e,[r,a]=(0,l.useState)([]),[o,n]=(0,l.useState)(0),[i,c]=(0,l.useState)(null);return((0,l.useEffect)(()=>{let e=async()=>{try{let e=await fetch("/api/projectsPictures",{method:"GET",headers:{property_id:t.toString()}});if(!e.ok)throw Error("Network response was not ok: ".concat(e.statusText));let r=await e.json();a(r.images||[])}catch(e){c("Error fetching images: ".concat(e.message)),console.error("Error fetching images:",e)}};t&&e()},[t]),i)?(0,s.jsxs)("div",{children:["Error loading images: ",i]}):(0,s.jsxs)("div",{className:"relative w-full h-64 md:h-96",children:[r.length>0?(0,s.jsx)("img",{src:r[o],alt:"Project ".concat(t," - Image ").concat(o+1),className:"w-full h-full object-cover rounded-md"}):(0,s.jsx)("p",{children:"אין תמונות זמינות"}),r.length>1&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>{n(e=>(e-1+r.length)%r.length)},className:"absolute left-0 top-1/2 transform -translate-y-1/2 text-gray-600 text-3xl md:text-4xl",children:"◀"}),(0,s.jsx)("button",{onClick:()=>{n(e=>(e+1)%r.length)},className:"absolute right-0 top-1/2 transform -translate-y-1/2 text-gray-600 text-3xl md:text-4xl",children:"▶"})]})]})},y=()=>{let[e,t]=(0,l.useState)([]),[r,o]=(0,l.useState)(null),[n,i]=(0,l.useState)(!1),[c,d]=(0,l.useState)(null),[x,h]=(0,l.useState)({}),[g,f]=(0,l.useState)(null),[j,y]=(0,l.useState)(!1),[N,w]=(0,l.useState)(!1),S=localStorage.getItem("user"),v=S?JSON.parse(S).userId:null,k=(0,a.useRouter)();(0,l.useEffect)(()=>{let e=async()=>{let e=new URLSearchParams;c&&e.append("city",c),x.minPrice&&e.append("minPrice",x.minPrice.toString()),x.maxPrice&&e.append("maxPrice",x.maxPrice.toString()),x.rooms&&e.append("rooms",x.rooms);try{let r=await fetch("/api/projects?".concat(e.toString()));if(!r.ok)throw Error("Failed to fetch data, status: ".concat(r.status));let s=await r.json();t(s)}catch(e){console.error("Error fetching projects:",e),f("Error fetching projects")}};c&&e()},[c,x]);let E=e=>{v||(localStorage.setItem("redirectAfterLogin",window.location.pathname),k.push("/login")),w(!0),P(e.property_id,"project"),o(e)},_=()=>{i(!1),o(null)},P=async(e,t)=>{let r=JSON.parse(localStorage.getItem("user")||"{}").userId||null;if(!r){localStorage.setItem("redirectAfterLogin",window.location.pathname),k.push("/login");return}try{let s=await fetch("/api/moreDetailsProjects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:e,userId:r,propertyType:t})});if(!s.ok)throw Error("Network response was not ok");(await s.json()).exists?o(e=>({...e,moreDetails:!0})):i(!0),y(!0),w(!1)}catch(e){f("Error checking contract: ".concat(e instanceof Error?e.message:"An unknown error occurred")),w(!1)}};return(0,s.jsxs)("div",{className:"text-white min-h-screen flex flex-col items-center p-6 rtl",children:[(0,s.jsxs)("div",{className:"w-full max-w-4xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6 text-gold text-center",children:"מצא את דירת הפרויקט המתאימה"}),(0,s.jsx)(u.Z,{onCitySelect:d}),c&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.Z,{onPriceChange:e=>{h(t=>({...t,minPrice:e.min,maxPrice:e.max}))},onRoomsChange:e=>{h(t=>({...t,rooms:e.toString()}))}}),(0,s.jsxs)("h2",{className:"text-2xl font-semibold mb-4 text-gold text-center",children:["דירות פרויקט ב",c]}),e.length>0?(0,s.jsx)("ul",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(e=>(0,s.jsxs)("li",{className:"bg-gray-800 p-4 rounded-lg border border-gold cursor-pointer rtl",children:[(0,s.jsxs)("p",{className:"text-lg font-medium",children:["שכונה/איזור: ",e.neighborhood]}),(0,s.jsxs)("p",{className:"text-md text-gold",children:["מחיר: ",Number(e.price).toLocaleString("he-IL",{maximumFractionDigits:0}),' ש"ח']}),(0,s.jsxs)("p",{className:"text-sm",children:["חדרים: ",e.rooms]}),(0,s.jsx)(b,{property_id:e.property_id}),(0,s.jsx)("button",{className:"mt-4 bg-gold text-black px-6 py-2 rounded-md font-semibold",onClick:()=>E(e),disabled:N,children:N?"בודק...":"פרטים נוספים"}),j&&(null==r?void 0:r.property_id)===e.property_id&&!n&&(0,s.jsxs)("div",{className:"mt-4 text-gold",children:[(0,s.jsxs)("p",{children:["כתובת: ",e.address]}),(0,s.jsxs)("p",{children:["פרטי יצירת קשר: ",e.contact_seller]})]}),n&&(null==r?void 0:r.property_id)===e.property_id&&(0,s.jsx)(m,{selectedProperty:r,property_type:"project",onClose:_})]},e.property_id))}):(0,s.jsx)("p",{className:"text-center text-xl text-gray-400 mt-4",children:"לא נמצאו פרויקט מתאים."})]})]}),g&&(0,s.jsx)("div",{className:"text-red-600 text-center mt-4",children:g})]})},N=r(81054),w=r(6406);r(97425),r(49608);var S=()=>{let[e,t]=(0,l.useState)([]),[r,o]=(0,l.useState)(null),[n,i]=(0,l.useState)(null),[c,d]=(0,l.useState)(!1),u=localStorage.getItem("user"),p=u?JSON.parse(u).userId:null,h=(0,a.useRouter)();(0,l.useEffect)(()=>{(async()=>{d(!0);try{let e=await fetch("/api/apartments");if(!e.ok)throw Error("Failed to fetch data, status: ".concat(e.status));let r=await e.json();t(r)}catch(e){console.error("Error fetching apartments:",e),i("שגיאה בטעינת הדירות, נסה שוב מאוחר יותר")}finally{d(!1)}})()},[]);let g=async e=>{if(!p){localStorage.setItem("redirectAfterLogin",window.location.pathname),h.push("/login");return}try{let t=await fetch("/api/moreDetailsApartments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apartmentId:e.property_id,userId:p,propertyType:"apartment"})});if(!t.ok)throw Error("Network response was not ok");(await t.json()).exists?alert("החוזה עבור דירה זו כבר חתום.\nכתובת: ".concat(e.address,"\nפרטי יצירת קשר: ").concat(e.contact_seller)):o(e)}catch(e){console.error("Error checking contract:",e),i("שגיאה בבדיקת החוזה. נסה שוב מאוחר יותר.")}};return(0,s.jsxs)("div",{className:"text-white min-h-screen flex flex-col items-center p-6 rtl",children:[c?(0,s.jsx)("p",{className:"text-center text-xl text-gray-400 mt-4",children:"טוען דירות..."}):n?(0,s.jsx)("div",{className:"text-red-600 text-center mt-4",children:n}):e.length>0?(0,s.jsx)(w.Z,{dots:!0,infinite:!0,speed:500,slidesToShow:3,slidesToScroll:1,autoplay:!0,autoplaySpeed:3e3,responsive:[{breakpoint:1024,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:600,settings:{slidesToShow:1,slidesToScroll:1}}],className:"w-full max-w-5xl",children:e.map(e=>(0,s.jsx)("div",{className:"p-4 relative",children:(0,s.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg border border-gold",children:[(0,s.jsxs)("p",{className:"text-lg font-medium",children:["עיר: ",e.city]}),(0,s.jsxs)("p",{className:"text-lg font-medium",children:["שכונה: ",e.neighborhood]}),(0,s.jsxs)("p",{className:"text-md text-gold",children:["מחיר: ",Number(e.price).toLocaleString("he-IL",{maximumFractionDigits:0}),' ש"ח']}),(0,s.jsxs)("p",{className:"text-sm",children:["חדרים: ",e.rooms]}),(0,s.jsx)(x,{property_id:e.property_id}),(0,s.jsx)("button",{className:"mt-4 bg-gold text-black px-6 py-2 rounded-md font-semibold",onClick:()=>g(e),children:"פרטים נוספים"})]})},e.property_id))}):(0,s.jsx)("p",{className:"text-center text-xl text-gray-400 mt-4",children:"לא נמצאו דירות."}),r&&(0,s.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-80 z-50",children:(0,s.jsx)(m,{selectedProperty:r,property_type:"apartment",onClose:()=>{o(null)}})})]})},v=()=>{let[e,t]=(0,l.useState)(null),{setUser:r,setUserType:a,setUserId:o,setRemainingListings:n}=(0,N.b)();return(0,l.useEffect)(()=>{let e=localStorage.getItem("user");if(e){let t=JSON.parse(e);r(t.username),a(t.userType),o(t.userId),n(t.remainingListings)}},[]),(0,s.jsxs)(N.R,{children:[(0,s.jsxs)("div",{className:"container mx-auto p-4",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-6 text-center",children:"תמצא את הנכס או הקרקע המושלם המתאים לצרכים שלך"}),(0,s.jsx)(g,{onSelect:t}),(0,s.jsx)("div",{className:"mt-6",children:(()=>{if(!e)return null;switch(e){case"דירות":return(0,s.jsx)(h,{},"apartments");case"בתי עסק":return(0,s.jsx)(j,{},"business");case"קרקעות":return(0,s.jsx)(f,{},"land");case"פרויקט קבלן":return(0,s.jsx)(y,{},"projects");default:return null}})()}),(0,s.jsx)("div",{})]}),(0,s.jsx)("div",{className:"mt-12",children:(0,s.jsx)(S,{})})]})}},86047:function(e,t,r){"use strict";var s=r(57437),l=r(2265);t.Z=e=>{let{onCitySelect:t}=e,[r,a]=(0,l.useState)([]),[o,n]=(0,l.useState)(""),[i,c]=(0,l.useState)(null),[d,m]=(0,l.useState)(null),x=async()=>{try{var e;let t=await fetch("https://data.gov.il/api/3/action/datastore_search?resource_id=d4901968-dad3-4845-a9b0-a57d027f11ab");if(!t.ok)throw Error("Network response was not ok");let r=await t.json();if(r.success&&(null===(e=r.result)||void 0===e?void 0:e.records)){let e=r.result.records.map(e=>e["שם_ישוב"]).filter(e=>e);a(e)}else throw Error("Unexpected data format")}catch(e){m("Error fetching cities: ".concat(e instanceof Error?e.message:"An unknown error occurred")),console.error("Error fetching cities:",e)}};(0,l.useEffect)(()=>{x()},[]);let u=e=>{c(e),n(""),t(e)},p=r.filter(e=>e.toLowerCase().includes(o.toLowerCase()));return(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"city-search",className:"block text-lg font-semibold mb-2 text-center",children:"בחר עיר:"}),(0,s.jsx)("input",{id:"city-search",type:"text",placeholder:"...הקלד שם העיר",value:o||i||"",onChange:e=>{n(e.target.value),c(null)},className:"bg-gray-800 text-white border border-gold rounded-md px-4 py-2 w-full"}),o&&(0,s.jsx)("ul",{className:"mt-2 bg-gray-800 border border-gold rounded-md max-h-48 overflow-y-auto",children:p.map((e,t)=>(0,s.jsx)("li",{onClick:()=>u(e),className:"px-4 py-2 cursor-pointer hover:bg-gray-700",children:e},t))}),d&&(0,s.jsx)("div",{className:"text-red-600 mb-4 text-center",children:d})]})}},3339:function(e,t,r){"use strict";var s=r(57437),l=r(2265);t.Z=e=>{let{onPriceChange:t,onRoomsChange:r}=e,[a,o]=(0,l.useState)(0),[n,i]=(0,l.useState)(6e8);return(0,s.jsxs)("div",{className:"filters-container mb-6 bg-transparent rounded-lg shadow-lg p-6 max-w-md mx-auto space-y-6",dir:"rtl",children:[(0,s.jsxs)("div",{className:"filter-item",children:[(0,s.jsx)("label",{className:"block text-gold font-semibold mb-2 text-right",children:"טווח מחיר:"}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsxs)("div",{className:"w-1/2",children:[(0,s.jsx)("label",{htmlFor:"minPrice",className:"block text-gold-lighter text-sm mb-1 text-right",children:"מינימום"}),(0,s.jsx)("input",{type:"number",id:"minPrice",min:"0",max:"600000000",step:"50000",value:a,onChange:e=>{let r=Number(e.target.value);o(r),t({min:r,max:n})},className:"w-full bg-transparent border border-gold rounded-lg py-2 px-3 text-gold focus:outline-none focus:border-gold-light placeholder-gold-lighter",placeholder:"מינימום"})]}),(0,s.jsxs)("div",{className:"w-1/2",children:[(0,s.jsx)("label",{htmlFor:"maxPrice",className:"block text-gold-lighter text-sm mb-1 text-right",children:"מקסימום"}),(0,s.jsx)("input",{type:"number",id:"maxPrice",min:"0",max:"600000000",step:"50000",value:n,onChange:e=>{let r=Number(e.target.value);i(r),t({min:a,max:r})},className:"w-full bg-transparent border border-gold rounded-lg py-2 px-3 text-gold focus:outline-none focus:border-gold-light placeholder-gold-lighter",placeholder:"מקסימום"})]})]})]}),(0,s.jsxs)("div",{className:"filter-item",children:[(0,s.jsx)("label",{htmlFor:"rooms",className:"block text-gold font-semibold mb-2 text-right",children:"חדרים:"}),(0,s.jsx)("input",{type:"number",id:"rooms",min:"1",onChange:e=>{r(Number(e.target.value))},className:"w-full bg-transparent border border-gold rounded-lg py-2 px-3 text-gold focus:outline-none focus:border-gold-light placeholder-gold-lighter",placeholder:"בחר מספר חדרים"})]})]})}}},function(e){e.O(0,[977,505,337,808,971,117,744],function(){return e(e.s=12885)}),_N_E=e.O()}]);