(()=>{var e={};e.id=130,e.ids=[130],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},86217:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>x,originalPathname:()=>p,pages:()=>i,routeModule:()=>m,tree:()=>c}),r(82610),r(11506),r(35866);var s=r(23191),a=r(88716),n=r(37922),o=r.n(n),l=r(95231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);r.d(t,d);let c=["",{children:["adminInterface",{children:["ShowApartments",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,82610)),"C:\\Users\\Malki\\OneDrive\\שולחן העבודה\\פרויקט מאגר דירות\\Apartments\\app\\adminInterface\\ShowApartments\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,11506)),"C:\\Users\\Malki\\OneDrive\\שולחן העבודה\\פרויקט מאגר דירות\\Apartments\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],i=["C:\\Users\\Malki\\OneDrive\\שולחן העבודה\\פרויקט מאגר דירות\\Apartments\\app\\adminInterface\\ShowApartments\\page.tsx"],p="/adminInterface/ShowApartments/page",x={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/adminInterface/ShowApartments/page",pathname:"/adminInterface/ShowApartments",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},54714:(e,t,r)=>{Promise.resolve().then(r.bind(r,73487))},73487:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var s=r(10326),a=r(17577),n=r(86029),o=r(1571);let l=()=>{let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)(null),[d,c]=(0,a.useState)(null),[i,p]=(0,a.useState)({min:0,max:1e6}),[x,m]=(0,a.useState)(0),[h,g]=(0,a.useState)([]),[u,b]=(0,a.useState)(null),[f,j]=(0,a.useState)(!1),w=async()=>{try{let e=encodeURIComponent(d?.trim()||""),r=await fetch(`/api/AdminInterface/ShowApartments?city=${e}`);if(!r.ok)throw Error("Response from server was not OK");let s=await r.json();t(s)}catch(e){l("Error fetching apartments: "+(e instanceof Error?e.message:"Unknown error")),console.error(e)}},N=async r=>{if(window.confirm("האם אתה בטוח שברצונך למחוק דירה זו?"))try{if(!(await fetch(`/api/AdminInterface/DeleteApartment?property_id=${r}`,{method:"DELETE"})).ok)throw Error("מחיקה נכשלה");alert("הדירה נמחקה בהצלחה"),t(e.filter(e=>e.property_id!==r))}catch(e){l("Error deleting apartment: "+(e instanceof Error?e.message:"Unknown error")),console.error(e)}},y=async e=>{try{b(e);let t=await fetch(`/api/AdminInterface/contracts?property_id=${e}`);if(!t.ok)throw Error("Response from server was not OK");let r=await t.json();g(r),j(!0)}catch(e){l("Error fetching contracts: "+(e instanceof Error?e.message:"Unknown error")),console.error(e)}};(0,a.useEffect)(()=>{w()},[d]);let _=e.filter(e=>{let t=e.price>=i.min&&e.price<=i.max,r=!x||e.rooms===x;return t&&r}),v=(e,t)=>{let r=`/contracts/${e}/${t}/contract.pdf`;try{window.open(r,"_blank"),console.log("נפתח חלון חדש עם ה-PDF")}catch(e){console.error("שגיאה בפתיחת ה-PDF:",e)}},k=(e,t)=>{let r=`/contracts/${e}/${t}/id_image.png`,s=`/contracts/${e}/${t}/id_image.jpg`,a=e=>{window.open(e,"_blank")};a(r),a(s)};return s.jsx("div",{className:"bg-transparent text-white min-h-screen flex flex-col items-center p-6",children:(0,s.jsxs)("div",{className:"w-full max-w-4xl mx-auto",children:[s.jsx("h1",{className:"text-2xl font-bold mb-6 text-gold text-center",children:"רשימת דירות"}),r&&(0,s.jsxs)("div",{className:"text-red-600 mb-4 text-center",children:["שגיאה: ",r]}),s.jsx(n.Z,{onPriceChange:p,onRoomsChange:m}),s.jsx(o.Z,{onCitySelect:c}),_.length>0?(0,s.jsxs)("table",{className:"min-w-full bg-transparent border border-gold mb-6",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gold",children:[s.jsx("th",{className:"text-left p-4",children:"מזהה נכס"}),s.jsx("th",{className:"text-left p-4",children:"עיר"}),s.jsx("th",{className:"text-left p-4",children:"מחיר"}),s.jsx("th",{className:"text-left p-4",children:"חדרים"}),s.jsx("th",{className:"text-left p-4",children:"פעולה"})]})}),s.jsx("tbody",{children:_.map(e=>(0,s.jsxs)("tr",{className:`border-b border-gold ${u===e.property_id?"bg-gold/10":""}`,children:[s.jsx("td",{className:"p-4",children:e.property_id}),s.jsx("td",{className:"p-4",children:e.city}),s.jsx("td",{className:"p-4",children:e.price}),s.jsx("td",{className:"p-4",children:e.rooms}),s.jsx("button",{onClick:()=>N(e.property_id),className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-700",children:"מחק דירה"}),s.jsx("td",{className:"p-4",children:s.jsx("button",{onClick:()=>y(e.property_id),className:"bg-gold text-black px-4 py-2 rounded hover:bg-yellow-600",children:"הצג חוזים"})})]},e.property_id))})]}):s.jsx("p",{className:"text-gray-400 text-center",children:"...טוען"}),f&&s.jsx("div",{className:"fixed inset-0 bg-black/70 flex justify-center items-center z-50",children:(0,s.jsxs)("div",{className:"bg-black text-gold p-6 rounded-lg max-w-4xl w-full max-h-screen overflow-auto",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"חוזים"}),s.jsx("button",{onClick:()=>j(!1),className:"text-red-500 mb-4 text-lg",children:"סגור"}),(0,s.jsxs)("div",{className:"overflow-x-auto max-h-80",children:[" ",(0,s.jsxs)("table",{className:"min-w-full bg-transparent border border-gold rounded-lg overflow-hidden shadow-lg",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gold text-gold",children:[s.jsx("th",{className:"p-4",children:"מזהה חוזה"}),s.jsx("th",{className:"p-4",children:"מזהה נכס"}),s.jsx("th",{className:"p-4",children:"סוג נכס"}),s.jsx("th",{className:"p-4 text-center",children:"תאריך"}),s.jsx("th",{className:"p-4",children:"מזהה משתמש"})]})}),s.jsx("tbody",{children:h.map((e,t)=>(0,s.jsxs)("tr",{className:"border-b border-gold hover:bg-gold/10 transition",children:[s.jsx("td",{className:"p-4 text-gold",children:e.contract_id}),s.jsx("td",{className:"p-4 text-gold",children:e.property_id}),s.jsx("td",{className:"p-4 text-gold",children:e.property_type}),s.jsx("td",{className:"p-4 text-gold",children:e.signed_date}),s.jsx("td",{className:"p-4 text-gold",children:e.user_id}),s.jsx("td",{className:"p-4 text-center",children:s.jsx("button",{className:"bg-transparent border border-gold text-gold py-1 px-3 rounded hover:bg-gold hover:text-black transition shadow-gold-glow",onClick:()=>v(e.property_type,e.contract_id),children:"הצגת החוזה"})}),s.jsx("td",{className:"p-4 text-center",children:s.jsx("button",{className:"bg-transparent border border-gold text-gold py-1 px-3 rounded hover:bg-gold hover:text-black transition shadow-gold-glow",onClick:()=>k(e.property_type,e.contract_id),children:"הצגת צילום ת.ז."})})]},t))})]})]})]})})]})})}},82610:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(68570).createProxy)(String.raw`C:\Users\Malki\OneDrive\שולחן העבודה\פרויקט מאגר דירות\Apartments\app\adminInterface\ShowApartments\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,562,421],()=>r(86217));module.exports=s})();