(()=>{var e={};e.id=9886,e.ids=[9886],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},74566:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>x,originalPathname:()=>p,pages:()=>c,routeModule:()=>h,tree:()=>d}),r(4291),r(11506),r(35866);var s=r(23191),n=r(88716),a=r(37922),o=r.n(a),l=r(95231),i={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>l[e]);r.d(t,i);let d=["",{children:["adminInterface",{children:["ShowAsset",{children:["ShowBusiness",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,4291)),"C:\\Users\\Malki\\OneDrive\\שולחן העבודה\\פרויקט מאגר דירות\\Apartments\\app\\adminInterface\\ShowAsset\\ShowBusiness\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,11506)),"C:\\Users\\Malki\\OneDrive\\שולחן העבודה\\פרויקט מאגר דירות\\Apartments\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\Malki\\OneDrive\\שולחן העבודה\\פרויקט מאגר דירות\\Apartments\\app\\adminInterface\\ShowAsset\\ShowBusiness\\page.tsx"],p="/adminInterface/ShowAsset/ShowBusiness/page",x={require:r,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/adminInterface/ShowAsset/ShowBusiness/page",pathname:"/adminInterface/ShowAsset/ShowBusiness",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},56762:(e,t,r)=>{Promise.resolve().then(r.bind(r,26763))},26763:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var s=r(10326),n=r(17577),a=r(1571);let o=()=>{let[e,t]=(0,n.useState)([]),[r,o]=(0,n.useState)(null),[l,i]=(0,n.useState)(null),[d,c]=(0,n.useState)({min:0,max:1e8}),[p,x]=(0,n.useState)([]),[h,m]=(0,n.useState)(null),[g,u]=(0,n.useState)(!1),b=async()=>{try{let e=encodeURIComponent(l?.trim()||""),r=await fetch(`/api/AdminInterface/ShowAsset/ShowBusiness?city=${e}`);if(!r.ok)throw Error("Response from server was not OK");let s=await r.json();t(s)}catch(e){o("Error fetching business: "+(e instanceof Error?e.message:"Unknown error")),console.error(e)}},f=async r=>{if(window.confirm("האם אתה בטוח שברצונך למחוק נכס זה?"))try{if(!(await fetch(`/api/AdminInterface/DeletedAsset/DeleteBusiness?property_id=${r}`,{method:"DELETE"})).ok)throw Error("מחיקה נכשלה");alert("הנכס נמחק בהצלחה"),t(e.filter(e=>e.property_id!==r))}catch(e){o("Error deleting business: "+(e instanceof Error?e.message:"Unknown error")),console.error(e)}},j=async e=>{try{m(e);let t=await fetch(`/api/AdminInterface/contracts?property_id=${e}`);if(!t.ok)throw Error("Response from server was not OK");let r=await t.json();x(r),u(!0)}catch(e){o("Error fetching contracts: "+(e instanceof Error?e.message:"Unknown error")),console.error(e)}};(0,n.useEffect)(()=>{b()},[l]);let w=e.filter(e=>e.price>=d.min&&e.price<=d.max),N=(e,t)=>{let r=`/contracts/${e}/${t}/contract.pdf`;try{window.open(r,"_blank"),console.log("נפתח חלון חדש עם ה-PDF")}catch(e){console.error("שגיאה בפתיחת ה-PDF:",e)}},y=(e,t)=>{let r=`/contracts/${e}/${t}/id_image.png`,s=`/contracts/${e}/${t}/id_image.jpg`,n=e=>{window.open(e,"_blank")};n(r),n(s)};return s.jsx("div",{className:"bg-transparent text-white min-h-screen flex flex-col items-center p-6",children:(0,s.jsxs)("div",{className:"w-full max-w-4xl mx-auto",children:[s.jsx("h1",{className:"text-2xl font-bold mb-6 text-gold text-center",children:"רשימת בתי עסק"}),r&&(0,s.jsxs)("div",{className:"text-red-600 mb-4 text-center",children:["שגיאה: ",r]}),s.jsx(a.Z,{onCitySelect:i}),w.length>0?(0,s.jsxs)("table",{className:"min-w-full bg-transparent border border-gold mb-6",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gold",children:[s.jsx("th",{className:"text-left p-4",children:"מזהה נכס"}),s.jsx("th",{className:"text-left p-4",children:"עיר"}),s.jsx("th",{className:"text-left p-4",children:"מחיר"}),s.jsx("th",{className:"text-left p-4",children:"פעולה"})]})}),s.jsx("tbody",{children:w.map(e=>(0,s.jsxs)("tr",{className:`border-b border-gold ${h===e.property_id?"bg-gold/10":""}`,children:[s.jsx("td",{className:"p-4",children:e.property_id}),s.jsx("td",{className:"p-4",children:e.city}),s.jsx("td",{className:"p-4",children:Number(e.price).toLocaleString("he-IL",{maximumFractionDigits:0})}),s.jsx("td",{className:"p-4",children:e.rooms}),s.jsx("button",{onClick:()=>f(e.property_id),className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-700",children:"מחק נכס"}),s.jsx("td",{className:"p-4",children:s.jsx("button",{onClick:()=>j(e.property_id),className:"bg-gold text-black px-4 py-2 rounded hover:bg-yellow-600",children:"הצג חוזים"})})]},e.property_id))})]}):s.jsx("p",{className:"text-gray-400 text-center",children:"...טוען"}),g&&s.jsx("div",{className:"fixed inset-0 bg-black/70 flex justify-center items-center z-50",children:(0,s.jsxs)("div",{className:"bg-black text-gold p-6 rounded-lg max-w-4xl w-full max-h-screen overflow-auto",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"חוזים"}),s.jsx("button",{onClick:()=>u(!1),className:"text-red-500 mb-4 text-lg",children:"סגור"}),(0,s.jsxs)("div",{className:"overflow-x-auto max-h-80",children:[" ",(0,s.jsxs)("table",{className:"min-w-full bg-transparent border border-gold rounded-lg overflow-hidden shadow-lg",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gold text-gold",children:[s.jsx("th",{className:"p-4",children:"מזהה חוזה"}),s.jsx("th",{className:"p-4",children:"מזהה נכס"}),s.jsx("th",{className:"p-4",children:"סוג נכס"}),s.jsx("th",{className:"p-4 text-center",children:"תאריך"}),s.jsx("th",{className:"p-4",children:"מזהה משתמש"})]})}),s.jsx("tbody",{children:p.map((e,t)=>(0,s.jsxs)("tr",{className:"border-b border-gold hover:bg-gold/10 transition",children:[s.jsx("td",{className:"p-4 text-gold",children:e.contract_id}),s.jsx("td",{className:"p-4 text-gold",children:e.property_id}),s.jsx("td",{className:"p-4 text-gold",children:e.property_type}),s.jsx("td",{className:"p-4 text-gold",children:e.signed_date}),s.jsx("td",{className:"p-4 text-gold",children:e.user_id}),s.jsx("td",{className:"p-4 text-center",children:s.jsx("button",{className:"bg-transparent border border-gold text-gold py-1 px-3 rounded hover:bg-gold hover:text-black transition shadow-gold-glow",onClick:()=>N(e.property_type,e.contract_id),children:"הצגת החוזה"})}),s.jsx("td",{className:"p-4 text-center",children:s.jsx("button",{className:"bg-transparent border border-gold text-gold py-1 px-3 rounded hover:bg-gold hover:text-black transition shadow-gold-glow",onClick:()=>y(e.property_type,e.contract_id),children:"הצגת צילום ת.ז."})})]},t))})]})]})]})})]})})}},4291:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(68570).createProxy)(String.raw`C:\Users\Malki\OneDrive\שולחן העבודה\פרויקט מאגר דירות\Apartments\app\adminInterface\ShowAsset\ShowBusiness\page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9276,5562,238],()=>r(74566));module.exports=s})();