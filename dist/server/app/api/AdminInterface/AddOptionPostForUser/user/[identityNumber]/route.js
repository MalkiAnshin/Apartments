"use strict";(()=>{var e={};e.id=6796,e.ids=[6796],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},35900:e=>{e.exports=require("pg")},11530:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>A,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>f,staticGenerationAsyncStorage:()=>y});var n={};t.r(n),t.d(n,{GET:()=>p,PATCH:()=>c,dynamic:()=>d});var s=t(49303),o=t(88716),i=t(60670),u=t(87070),a=t(68735);let d="force-dynamic";async function p(e,{params:r}){let{identityNumber:t}=r;try{let e=await a.Z.query("SELECT * FROM USERS WHERE identity_number = $1",[t]);if(0===e.rows.length)return u.NextResponse.json({error:"משתמש לא נמצא"},{status:404});return u.NextResponse.json({name:e.rows[0].username,identityNumber:e.rows[0].identity_number})}catch(e){return console.error("Error during GET request:",e),u.NextResponse.json({error:"שגיאה בשרת"},{status:500})}}async function c(e,{params:r}){let{identityNumber:t}=r,{incrementValue:n}=await e.json();console.log("Received PATCH request for identityNumber:",t),console.log("Received incrementValue:",n);try{let e=`
      UPDATE USERS 
      SET remaining_listings = remaining_listings + $1 
      WHERE identity_number = $2
    `;console.log("Executing UPDATE query:",e,"with identityNumber:",t,"and incrementValue:",n);let r=await a.Z.query(e,[n,t]);if(0===r.rowCount)return console.log(`Failed to update user for identityNumber: ${t}. No rows affected.`),u.NextResponse.json({error:"לא ניתן לעדכן את המשתמש"},{status:400});return console.log(`User updated successfully for identityNumber: ${t}. Rows affected: ${r.rowCount}`),u.NextResponse.json({message:"הערך שונה בהצלחה"})}catch(e){return console.error("Error during PATCH request:",e),u.NextResponse.json({error:"שגיאה בשרת"},{status:500})}}let l=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/AdminInterface/AddOptionPostForUser/user/[identityNumber]/route",pathname:"/api/AdminInterface/AddOptionPostForUser/user/[identityNumber]",filename:"route",bundlePath:"app/api/AdminInterface/AddOptionPostForUser/user/[identityNumber]/route"},resolvedPagePath:"C:\\Users\\Malki\\OneDrive\\שולחן העבודה\\פרויקט מאגר דירות\\Apartments\\app\\api\\AdminInterface\\AddOptionPostForUser\\user\\[identityNumber]\\route.tsx",nextConfigOutput:"",userland:n}),{requestAsyncStorage:m,staticGenerationAsyncStorage:y,serverHooks:f}=l,g="/api/AdminInterface/AddOptionPostForUser/user/[identityNumber]/route";function A(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:y})}},68735:(e,r,t)=>{t.d(r,{Z:()=>s});let{Pool:n}=t(35900),s=new n({user:process.env.DB_USER,host:process.env.DB_HOST,database:process.env.DB_NAME,password:process.env.DB_PASSWORD,port:process.env.DB_PORT,ssl:!1})}};var r=require("../../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[9276,5972],()=>t(11530));module.exports=n})();