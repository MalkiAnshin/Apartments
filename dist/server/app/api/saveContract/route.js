"use strict";(()=>{var e={};e.id=708,e.ids=[708],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5900:e=>{e.exports=require("pg")},5816:(e,s,t)=>{t.r(s),t.d(s,{originalPathname:()=>g,patchFetch:()=>h,requestAsyncStorage:()=>d,routeModule:()=>u,serverHooks:()=>v,staticGenerationAsyncStorage:()=>l});var r={};t.r(r),t.d(r,{POST:()=>c});var o=t(3278),a=t(5002),n=t(4877),i=t(1309),p=t(8966);async function c(e){try{let{userId:s,property_type:t,fileName:r,pdfBytes:o,signed_date:a,property_id:n,notes:c}=await e.json(),u=[];if(s||u.push("userId"),t||u.push("property_type"),r||u.push("fileName"),n||u.push("property_id"),c||u.push("notes"),o||u.push("pdfBytes"),u.length>0)return console.error("Missing required fields:",u),i.NextResponse.json({success:!1,message:"Missing required fields",missingFields:u},{status:400});let d=a||new Date().toISOString(),l=await p.Z.query("INSERT INTO contracts (user_id, property_type, file_name, signed_date, property_id, notes) VALUES ($1, $2, $3, $4, $5, $6) RETURNING contract_id",[s,t,r,d,n,c]);if(!l||0===l.rows.length)return console.error("Failed to insert contract data."),i.NextResponse.json({success:!1,message:"Failed to insert contract data"},{status:500});let v=l.rows[0].contract_id;return i.NextResponse.json({success:!0,contractId:v,message:"Contract saved successfully"})}catch(e){return console.error("Error saving contract:",e),i.NextResponse.json({success:!1,message:"Error saving contract",error:e.message},{status:500})}}let u=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/saveContract/route",pathname:"/api/saveContract",filename:"route",bundlePath:"app/api/saveContract/route"},resolvedPagePath:"C:\\Users\\Malki\\OneDrive\\שולחן העבודה\\פרויקט מאגר דירות\\Apartments\\app\\api\\saveContract\\route.tsx",nextConfigOutput:"",userland:r}),{requestAsyncStorage:d,staticGenerationAsyncStorage:l,serverHooks:v}=u,g="/api/saveContract/route";function h(){return(0,n.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:l})}},8966:(e,s,t)=>{t.d(s,{Z:()=>o});let{Pool:r}=t(5900),o=new r({user:process.env.DB_USER,host:process.env.DB_HOST,database:process.env.DB_NAME,password:process.env.DB_PASSWORD,port:process.env.DB_PORT,ssl:{rejectUnauthorized:!1}})}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[379,833],()=>t(5816));module.exports=r})();